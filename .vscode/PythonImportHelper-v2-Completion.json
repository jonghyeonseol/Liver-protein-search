[
    {
        "label": "pandas",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pandas",
        "description": "pandas",
        "detail": "pandas",
        "documentation": {}
    },
    {
        "label": "matplotlib.pyplot",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "matplotlib.pyplot",
        "description": "matplotlib.pyplot",
        "detail": "matplotlib.pyplot",
        "documentation": {}
    },
    {
        "label": "numpy",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "numpy",
        "description": "numpy",
        "detail": "numpy",
        "documentation": {}
    },
    {
        "label": "Patch",
        "importPath": "matplotlib.patches",
        "description": "matplotlib.patches",
        "isExtraImport": true,
        "detail": "matplotlib.patches",
        "documentation": {}
    },
    {
        "label": "Patch",
        "importPath": "matplotlib.patches",
        "description": "matplotlib.patches",
        "isExtraImport": true,
        "detail": "matplotlib.patches",
        "documentation": {}
    },
    {
        "label": "roc_curve",
        "importPath": "sklearn.metrics",
        "description": "sklearn.metrics",
        "isExtraImport": true,
        "detail": "sklearn.metrics",
        "documentation": {}
    },
    {
        "label": "auc",
        "importPath": "sklearn.metrics",
        "description": "sklearn.metrics",
        "isExtraImport": true,
        "detail": "sklearn.metrics",
        "documentation": {}
    },
    {
        "label": "precision_recall_curve",
        "importPath": "sklearn.metrics",
        "description": "sklearn.metrics",
        "isExtraImport": true,
        "detail": "sklearn.metrics",
        "documentation": {}
    },
    {
        "label": "average_precision_score",
        "importPath": "sklearn.metrics",
        "description": "sklearn.metrics",
        "isExtraImport": true,
        "detail": "sklearn.metrics",
        "documentation": {}
    },
    {
        "label": "confusion_matrix",
        "importPath": "sklearn.metrics",
        "description": "sklearn.metrics",
        "isExtraImport": true,
        "detail": "sklearn.metrics",
        "documentation": {}
    },
    {
        "label": "classification_report",
        "importPath": "sklearn.metrics",
        "description": "sklearn.metrics",
        "isExtraImport": true,
        "detail": "sklearn.metrics",
        "documentation": {}
    },
    {
        "label": "sys",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "sys",
        "description": "sys",
        "detail": "sys",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "Path",
        "importPath": "pathlib",
        "description": "pathlib",
        "isExtraImport": true,
        "detail": "pathlib",
        "documentation": {}
    },
    {
        "label": "seaborn",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "seaborn",
        "description": "seaborn",
        "detail": "seaborn",
        "documentation": {}
    },
    {
        "label": "re",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "re",
        "description": "re",
        "detail": "re",
        "documentation": {}
    },
    {
        "label": "INPUT_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "OUTPUT_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRACE_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PROTEIN_ATLAS_FILE",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CSV_PATTERN",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "KNOWN_LIVER_MARKERS",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DPI",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "INPUT_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "OUTPUT_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRACE_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "PROTEIN_ATLAS_FILE",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CSV_PATTERN",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "NTPM_HIGH_THRESHOLD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DPI",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "FIGURE_SIZE_VENN",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRACE_DATA_FILE",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_SUMMARY_FILE",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "VENN_DIAGRAM_OUTPUT",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRACE_DATA_FILE",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "OUTPUT_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DPI",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRACE_DATA_FILE",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "OUTPUT_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TRACE_DIR",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "TOP_N_GENES",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "DPI",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "NTPM_HIGH_THRESHOLD",
        "importPath": "config",
        "description": "config",
        "isExtraImport": true,
        "detail": "config",
        "documentation": {}
    },
    {
        "label": "venn3",
        "importPath": "matplotlib_venn",
        "description": "matplotlib_venn",
        "isExtraImport": true,
        "detail": "matplotlib_venn",
        "documentation": {}
    },
    {
        "label": "subprocess",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "subprocess",
        "description": "subprocess",
        "detail": "subprocess",
        "documentation": {}
    },
    {
        "label": "time",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "time",
        "description": "time",
        "detail": "time",
        "documentation": {}
    },
    {
        "label": "Colors",
        "importPath": "console_utils",
        "description": "console_utils",
        "isExtraImport": true,
        "detail": "console_utils",
        "documentation": {}
    },
    {
        "label": "print_header",
        "importPath": "console_utils",
        "description": "console_utils",
        "isExtraImport": true,
        "detail": "console_utils",
        "documentation": {}
    },
    {
        "label": "print_step",
        "importPath": "console_utils",
        "description": "console_utils",
        "isExtraImport": true,
        "detail": "console_utils",
        "documentation": {}
    },
    {
        "label": "print_success",
        "importPath": "console_utils",
        "description": "console_utils",
        "isExtraImport": true,
        "detail": "console_utils",
        "documentation": {}
    },
    {
        "label": "print_error",
        "importPath": "console_utils",
        "description": "console_utils",
        "isExtraImport": true,
        "detail": "console_utils",
        "documentation": {}
    },
    {
        "label": "print_warning",
        "importPath": "console_utils",
        "description": "console_utils",
        "isExtraImport": true,
        "detail": "console_utils",
        "documentation": {}
    },
    {
        "label": "Line2D",
        "importPath": "matplotlib.lines",
        "description": "matplotlib.lines",
        "isExtraImport": true,
        "detail": "matplotlib.lines",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_COLOR_MAP",
        "importPath": "visualization_config",
        "description": "visualization_config",
        "isExtraImport": true,
        "detail": "visualization_config",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_ORDER",
        "importPath": "visualization_config",
        "description": "visualization_config",
        "isExtraImport": true,
        "detail": "visualization_config",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_COLOR_MAP",
        "importPath": "visualization_config",
        "description": "visualization_config",
        "isExtraImport": true,
        "detail": "visualization_config",
        "documentation": {}
    },
    {
        "label": "argparse",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "argparse",
        "description": "argparse",
        "detail": "argparse",
        "documentation": {}
    },
    {
        "label": "Colors",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_header",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_step",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_success",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_error",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_warning",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_info",
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "isExtraImport": true,
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "calculate_confidence_score",
        "kind": 2,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "def calculate_confidence_score(row):\n    \"\"\"\n    Calculate confidence score based on:\n    - nTPM value (0-40 points)\n    - Number of criteria met (0-30 points)\n    - Presence in cluster (0-15 points)\n    - Presence in enrichment (0-15 points)\n    \"\"\"\n    score = 0\n    # nTPM-based scoring (0-40 points)",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "classify_by_confidence",
        "kind": 2,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "def classify_by_confidence(score):\n    if score >= 80:\n        return 'High Confidence'\n    elif score >= 60:\n        return 'Medium-High Confidence'\n    elif score >= 40:\n        return 'Medium Confidence'\n    elif score >= 20:\n        return 'Low-Medium Confidence'\n    else:",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "trace_data",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "trace_data = pd.read_csv('Trace/Data tracing.csv')\n# Create combined nTPM column for compatibility\ntrace_data['has_liver_in_ntpm'] = (trace_data['has_liver_nTPM_high'] == True) | (trace_data['has_liver_nTPM_low'] == True)\nprint(\"\\n\" + \"=\"*80)\nprint(\"LIVER PROTEIN CLASSIFICATION STRATEGY ANALYSIS\")\nprint(\"=\"*80)\n# ============================================================================\n# STRATEGY 1: Current Multi-Criteria Approach\n# ============================================================================\nprint(\"\\n### STRATEGY 1: Multi-Criteria Overlap ###\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "trace_data['has_liver_in_ntpm']",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "trace_data['has_liver_in_ntpm'] = (trace_data['has_liver_nTPM_high'] == True) | (trace_data['has_liver_nTPM_low'] == True)\nprint(\"\\n\" + \"=\"*80)\nprint(\"LIVER PROTEIN CLASSIFICATION STRATEGY ANALYSIS\")\nprint(\"=\"*80)\n# ============================================================================\n# STRATEGY 1: Current Multi-Criteria Approach\n# ============================================================================\nprint(\"\\n### STRATEGY 1: Multi-Criteria Overlap ###\")\nprint(\"-\" * 80)\ncurrent_stats = trace_data['Classification'].value_counts()",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "current_stats",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "current_stats = trace_data['Classification'].value_counts()\nprint(\"\\nCurrent Classification:\")\nprint(current_stats)\nliver_candidates = len(trace_data[trace_data['Classification'].str.startswith('liver protein')])\nprint(f\"\\nTotal Liver Candidates: {liver_candidates}\")\nprint(f\"Non-liver: {len(trace_data[trace_data['Classification'] == 'non-liver protein'])}\")\n# ============================================================================\n# STRATEGY 2: nTPM Threshold-Based Approach\n# ============================================================================\nprint(\"\\n\\n### STRATEGY 2: nTPM Threshold-Based Classification ###\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "liver_candidates",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "liver_candidates = len(trace_data[trace_data['Classification'].str.startswith('liver protein')])\nprint(f\"\\nTotal Liver Candidates: {liver_candidates}\")\nprint(f\"Non-liver: {len(trace_data[trace_data['Classification'] == 'non-liver protein'])}\")\n# ============================================================================\n# STRATEGY 2: nTPM Threshold-Based Approach\n# ============================================================================\nprint(\"\\n\\n### STRATEGY 2: nTPM Threshold-Based Classification ###\")\nprint(\"-\" * 80)\nliver_genes = trace_data[trace_data['liver_nTPM_value'].notna()].copy()\nprint(f\"\\nTotal genes with nTPM values: {len(liver_genes)}\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "liver_genes",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "liver_genes = trace_data[trace_data['liver_nTPM_value'].notna()].copy()\nprint(f\"\\nTotal genes with nTPM values: {len(liver_genes)}\")\n# Analyze nTPM value distribution\nntpm_values = liver_genes['liver_nTPM_value'].values\npercentiles = [25, 50, 75, 90, 95, 99]\nprint(\"\\nnTPM Value Percentiles:\")\nfor p in percentiles:\n    print(f\"  {p}th percentile: {np.percentile(ntpm_values, p):.2f}\")\n# Test different thresholds\nthresholds = [10, 50, 100, 200, 500, 1000]",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "ntpm_values",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "ntpm_values = liver_genes['liver_nTPM_value'].values\npercentiles = [25, 50, 75, 90, 95, 99]\nprint(\"\\nnTPM Value Percentiles:\")\nfor p in percentiles:\n    print(f\"  {p}th percentile: {np.percentile(ntpm_values, p):.2f}\")\n# Test different thresholds\nthresholds = [10, 50, 100, 200, 500, 1000]\nprint(\"\\nGenes above different nTPM thresholds:\")\nfor threshold in thresholds:\n    count = len(liver_genes[liver_genes['liver_nTPM_value'] >= threshold])",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "percentiles",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "percentiles = [25, 50, 75, 90, 95, 99]\nprint(\"\\nnTPM Value Percentiles:\")\nfor p in percentiles:\n    print(f\"  {p}th percentile: {np.percentile(ntpm_values, p):.2f}\")\n# Test different thresholds\nthresholds = [10, 50, 100, 200, 500, 1000]\nprint(\"\\nGenes above different nTPM thresholds:\")\nfor threshold in thresholds:\n    count = len(liver_genes[liver_genes['liver_nTPM_value'] >= threshold])\n    percentage = (count / len(liver_genes)) * 100",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "thresholds",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "thresholds = [10, 50, 100, 200, 500, 1000]\nprint(\"\\nGenes above different nTPM thresholds:\")\nfor threshold in thresholds:\n    count = len(liver_genes[liver_genes['liver_nTPM_value'] >= threshold])\n    percentage = (count / len(liver_genes)) * 100\n    print(f\"  nTPM >= {threshold}: {count} genes ({percentage:.1f}%)\")\n# ============================================================================\n# STRATEGY 3: Weighted Scoring System\n# ============================================================================\nprint(\"\\n\\n### STRATEGY 3: Weighted Scoring System ###\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "trace_data['confidence_score']",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "trace_data['confidence_score'] = trace_data.apply(calculate_confidence_score, axis=1)\n# Classify based on confidence scores\ndef classify_by_confidence(score):\n    if score >= 80:\n        return 'High Confidence'\n    elif score >= 60:\n        return 'Medium-High Confidence'\n    elif score >= 40:\n        return 'Medium Confidence'\n    elif score >= 20:",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "trace_data['confidence_class']",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "trace_data['confidence_class'] = trace_data['confidence_score'].apply(classify_by_confidence)\nprint(\"\\nConfidence-based Classification:\")\nprint(trace_data['confidence_class'].value_counts().sort_index(ascending=False))\nprint(\"\\nTop 10 genes by confidence score:\")\ntop_confidence = trace_data.nlargest(10, 'confidence_score')[['Gene', 'liver_nTPM_value', 'Classification', 'confidence_score']]\nprint(top_confidence.to_string(index=False))\n# ============================================================================\n# STRATEGY 4: Restrictive High-Stringency Approach\n# ============================================================================\nprint(\"\\n\\n### STRATEGY 4: High-Stringency Filtering ###\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "top_confidence",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "top_confidence = trace_data.nlargest(10, 'confidence_score')[['Gene', 'liver_nTPM_value', 'Classification', 'confidence_score']]\nprint(top_confidence.to_string(index=False))\n# ============================================================================\n# STRATEGY 4: Restrictive High-Stringency Approach\n# ============================================================================\nprint(\"\\n\\n### STRATEGY 4: High-Stringency Filtering ###\")\nprint(\"-\" * 80)\n# Define high-stringency criteria\nhigh_stringency = trace_data[\n    (trace_data['has_liver_in_ntpm'] == True) &",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "high_stringency",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "high_stringency = trace_data[\n    (trace_data['has_liver_in_ntpm'] == True) &\n    (trace_data['has_liver_cluster'] == True) &\n    (trace_data['liver_nTPM_value'] >= 100)\n]\nprint(f\"\\nHigh-Stringency Criteria:\")\nprint(f\"  - Must have liver in nTPM\")\nprint(f\"  - Must have liver in tissue cluster\")\nprint(f\"  - nTPM value >= 100\")\nprint(f\"\\nResult: {len(high_stringency)} genes\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "very_high_stringency",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "very_high_stringency = trace_data[\n    (trace_data['has_liver_in_ntpm'] == True) &\n    (trace_data['has_liver_cluster'] == True) &\n    (trace_data['has_liver_enrichment'] == True) &\n    (trace_data['liver_nTPM_value'] >= 200)\n]\nprint(f\"\\nVery High-Stringency Criteria:\")\nprint(f\"  - All 3 criteria must be met\")\nprint(f\"  - nTPM value >= 200\")\nprint(f\"\\nResult: {len(very_high_stringency)} genes\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "known_liver_markers",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "known_liver_markers = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1', 'FGA', 'FGB', 'FGG',\n    'CYP3A4', 'CYP2E1', 'FABP1', 'ALDOB', 'ORM1', 'ORM2', 'GC', 'TF',\n    'APOH', 'APOE', 'CRP', 'SAA1', 'SAA2', 'RBP4', 'AMBP', 'SELENOP'\n]\nprint(f\"\\nValidation against {len(known_liver_markers)} known liver markers:\")\nfound_markers = trace_data[trace_data['Gene'].isin(known_liver_markers)]\nprint(f\"  Found in dataset: {len(found_markers)}/{len(known_liver_markers)}\")\nclassified_as_liver = found_markers[found_markers['Classification'].str.startswith('liver protein')]\nprint(f\"  Classified as liver protein: {len(classified_as_liver)}/{len(found_markers)}\")",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "found_markers",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "found_markers = trace_data[trace_data['Gene'].isin(known_liver_markers)]\nprint(f\"  Found in dataset: {len(found_markers)}/{len(known_liver_markers)}\")\nclassified_as_liver = found_markers[found_markers['Classification'].str.startswith('liver protein')]\nprint(f\"  Classified as liver protein: {len(classified_as_liver)}/{len(found_markers)}\")\nif len(found_markers) > 0:\n    print(f\"  Capture rate: {(len(classified_as_liver)/len(found_markers))*100:.1f}%\")\n    print(\"\\nClassification of known markers:\")\n    marker_class = found_markers.groupby('Classification').size()\n    print(marker_class)\n    # Show markers NOT classified as liver",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "classified_as_liver",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "classified_as_liver = found_markers[found_markers['Classification'].str.startswith('liver protein')]\nprint(f\"  Classified as liver protein: {len(classified_as_liver)}/{len(found_markers)}\")\nif len(found_markers) > 0:\n    print(f\"  Capture rate: {(len(classified_as_liver)/len(found_markers))*100:.1f}%\")\n    print(\"\\nClassification of known markers:\")\n    marker_class = found_markers.groupby('Classification').size()\n    print(marker_class)\n    # Show markers NOT classified as liver\n    not_classified = found_markers[~found_markers['Classification'].str.startswith('liver protein')]\n    if len(not_classified) > 0:",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "ax1",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "ax1 = axes[0, 0]\ncurrent_liver = trace_data[trace_data['Classification'].str.startswith('liver protein')]['Classification'].value_counts()\ncolors1 = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#A8E6CF', '#FF8C42', '#95E1D3', '#C7CEEA']\ncurrent_liver.plot(kind='barh', ax=ax1, color=colors1[:len(current_liver)])\nax1.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax1.set_title('Strategy 1: Multi-Criteria Classification', fontsize=12, fontweight='bold')\nax1.grid(axis='x', alpha=0.3)\n# 2. Confidence Score Distribution\nax2 = axes[0, 1]\nconfidence_dist = trace_data['confidence_class'].value_counts().sort_index(ascending=False)",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "current_liver",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "current_liver = trace_data[trace_data['Classification'].str.startswith('liver protein')]['Classification'].value_counts()\ncolors1 = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#A8E6CF', '#FF8C42', '#95E1D3', '#C7CEEA']\ncurrent_liver.plot(kind='barh', ax=ax1, color=colors1[:len(current_liver)])\nax1.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax1.set_title('Strategy 1: Multi-Criteria Classification', fontsize=12, fontweight='bold')\nax1.grid(axis='x', alpha=0.3)\n# 2. Confidence Score Distribution\nax2 = axes[0, 1]\nconfidence_dist = trace_data['confidence_class'].value_counts().sort_index(ascending=False)\ncolors2 = ['#D32F2F', '#FF6B6B', '#FFA726', '#FFE66D', '#E8E8E8']",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "colors1",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "colors1 = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#A8E6CF', '#FF8C42', '#95E1D3', '#C7CEEA']\ncurrent_liver.plot(kind='barh', ax=ax1, color=colors1[:len(current_liver)])\nax1.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax1.set_title('Strategy 1: Multi-Criteria Classification', fontsize=12, fontweight='bold')\nax1.grid(axis='x', alpha=0.3)\n# 2. Confidence Score Distribution\nax2 = axes[0, 1]\nconfidence_dist = trace_data['confidence_class'].value_counts().sort_index(ascending=False)\ncolors2 = ['#D32F2F', '#FF6B6B', '#FFA726', '#FFE66D', '#E8E8E8']\nconfidence_dist.plot(kind='barh', ax=ax2, color=colors2)",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "ax2",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "ax2 = axes[0, 1]\nconfidence_dist = trace_data['confidence_class'].value_counts().sort_index(ascending=False)\ncolors2 = ['#D32F2F', '#FF6B6B', '#FFA726', '#FFE66D', '#E8E8E8']\nconfidence_dist.plot(kind='barh', ax=ax2, color=colors2)\nax2.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax2.set_title('Strategy 3: Confidence Score Classification', fontsize=12, fontweight='bold')\nax2.grid(axis='x', alpha=0.3)\n# 3. nTPM Threshold Comparison\nax3 = axes[1, 0]\nthreshold_data = []",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "confidence_dist",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "confidence_dist = trace_data['confidence_class'].value_counts().sort_index(ascending=False)\ncolors2 = ['#D32F2F', '#FF6B6B', '#FFA726', '#FFE66D', '#E8E8E8']\nconfidence_dist.plot(kind='barh', ax=ax2, color=colors2)\nax2.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax2.set_title('Strategy 3: Confidence Score Classification', fontsize=12, fontweight='bold')\nax2.grid(axis='x', alpha=0.3)\n# 3. nTPM Threshold Comparison\nax3 = axes[1, 0]\nthreshold_data = []\nthreshold_labels = []",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "colors2",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "colors2 = ['#D32F2F', '#FF6B6B', '#FFA726', '#FFE66D', '#E8E8E8']\nconfidence_dist.plot(kind='barh', ax=ax2, color=colors2)\nax2.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax2.set_title('Strategy 3: Confidence Score Classification', fontsize=12, fontweight='bold')\nax2.grid(axis='x', alpha=0.3)\n# 3. nTPM Threshold Comparison\nax3 = axes[1, 0]\nthreshold_data = []\nthreshold_labels = []\nfor threshold in [0, 10, 50, 100, 200, 500, 1000]:",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "ax3",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "ax3 = axes[1, 0]\nthreshold_data = []\nthreshold_labels = []\nfor threshold in [0, 10, 50, 100, 200, 500, 1000]:\n    count = len(liver_genes[liver_genes['liver_nTPM_value'] >= threshold])\n    threshold_data.append(count)\n    threshold_labels.append(f'≥{threshold}')\nbars = ax3.barh(threshold_labels, threshold_data, color='#4ECDC4', edgecolor='black', linewidth=1.5)\nax3.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax3.set_title('Strategy 2: nTPM Threshold Impact', fontsize=12, fontweight='bold')",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "threshold_data",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "threshold_data = []\nthreshold_labels = []\nfor threshold in [0, 10, 50, 100, 200, 500, 1000]:\n    count = len(liver_genes[liver_genes['liver_nTPM_value'] >= threshold])\n    threshold_data.append(count)\n    threshold_labels.append(f'≥{threshold}')\nbars = ax3.barh(threshold_labels, threshold_data, color='#4ECDC4', edgecolor='black', linewidth=1.5)\nax3.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax3.set_title('Strategy 2: nTPM Threshold Impact', fontsize=12, fontweight='bold')\nax3.grid(axis='x', alpha=0.3)",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "threshold_labels",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "threshold_labels = []\nfor threshold in [0, 10, 50, 100, 200, 500, 1000]:\n    count = len(liver_genes[liver_genes['liver_nTPM_value'] >= threshold])\n    threshold_data.append(count)\n    threshold_labels.append(f'≥{threshold}')\nbars = ax3.barh(threshold_labels, threshold_data, color='#4ECDC4', edgecolor='black', linewidth=1.5)\nax3.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax3.set_title('Strategy 2: nTPM Threshold Impact', fontsize=12, fontweight='bold')\nax3.grid(axis='x', alpha=0.3)\n# Add value labels",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "bars",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "bars = ax3.barh(threshold_labels, threshold_data, color='#4ECDC4', edgecolor='black', linewidth=1.5)\nax3.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax3.set_title('Strategy 2: nTPM Threshold Impact', fontsize=12, fontweight='bold')\nax3.grid(axis='x', alpha=0.3)\n# Add value labels\nfor i, (bar, val) in enumerate(zip(bars, threshold_data)):\n    ax3.text(val + max(threshold_data)*0.01, i, f'{val}', va='center', fontweight='bold')\n# 4. High-Stringency Tiers\nax4 = axes[1, 1]\nstringency_data = {",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "ax4",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "ax4 = axes[1, 1]\nstringency_data = {\n    'All liver\\ncandidates\\n(any criterion)': liver_candidates,\n    'nTPM only\\n(any value)': len(trace_data[trace_data['has_liver_in_ntpm'] == True]),\n    'nTPM + cluster\\n(any value)': len(trace_data[(trace_data['has_liver_in_ntpm'] == True) &\n                                                    (trace_data['has_liver_cluster'] == True)]),\n    'nTPM + cluster\\n(≥100)': len(high_stringency),\n    'All 3 criteria\\n(≥200)': len(very_high_stringency)\n}\ny_pos = np.arange(len(stringency_data))",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "stringency_data",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "stringency_data = {\n    'All liver\\ncandidates\\n(any criterion)': liver_candidates,\n    'nTPM only\\n(any value)': len(trace_data[trace_data['has_liver_in_ntpm'] == True]),\n    'nTPM + cluster\\n(any value)': len(trace_data[(trace_data['has_liver_in_ntpm'] == True) &\n                                                    (trace_data['has_liver_cluster'] == True)]),\n    'nTPM + cluster\\n(≥100)': len(high_stringency),\n    'All 3 criteria\\n(≥200)': len(very_high_stringency)\n}\ny_pos = np.arange(len(stringency_data))\ncolors4 = ['#E8E8E8', '#C7CEEA', '#95E1D3', '#4ECDC4', '#FF6B6B']",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "y_pos",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "y_pos = np.arange(len(stringency_data))\ncolors4 = ['#E8E8E8', '#C7CEEA', '#95E1D3', '#4ECDC4', '#FF6B6B']\nbars4 = ax4.barh(y_pos, list(stringency_data.values()), color=colors4, edgecolor='black', linewidth=1.5)\nax4.set_yticks(y_pos)\nax4.set_yticklabels(list(stringency_data.keys()), fontsize=9)\nax4.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax4.set_title('Strategy 4: Progressive Stringency Filtering', fontsize=12, fontweight='bold')\nax4.grid(axis='x', alpha=0.3)\n# Add value labels\nfor i, (bar, val) in enumerate(zip(bars4, stringency_data.values())):",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "colors4",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "colors4 = ['#E8E8E8', '#C7CEEA', '#95E1D3', '#4ECDC4', '#FF6B6B']\nbars4 = ax4.barh(y_pos, list(stringency_data.values()), color=colors4, edgecolor='black', linewidth=1.5)\nax4.set_yticks(y_pos)\nax4.set_yticklabels(list(stringency_data.keys()), fontsize=9)\nax4.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax4.set_title('Strategy 4: Progressive Stringency Filtering', fontsize=12, fontweight='bold')\nax4.grid(axis='x', alpha=0.3)\n# Add value labels\nfor i, (bar, val) in enumerate(zip(bars4, stringency_data.values())):\n    ax4.text(val + max(stringency_data.values())*0.01, i, f'{val}', va='center', fontweight='bold')",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "bars4",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "bars4 = ax4.barh(y_pos, list(stringency_data.values()), color=colors4, edgecolor='black', linewidth=1.5)\nax4.set_yticks(y_pos)\nax4.set_yticklabels(list(stringency_data.keys()), fontsize=9)\nax4.set_xlabel('Number of Genes', fontsize=11, fontweight='bold')\nax4.set_title('Strategy 4: Progressive Stringency Filtering', fontsize=12, fontweight='bold')\nax4.grid(axis='x', alpha=0.3)\n# Add value labels\nfor i, (bar, val) in enumerate(zip(bars4, stringency_data.values())):\n    ax4.text(val + max(stringency_data.values())*0.01, i, f'{val}', va='center', fontweight='bold')\nplt.tight_layout()",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "tier1",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "tier1 = trace_data[\n    (trace_data['has_liver_in_ntpm'] == True) &\n    (trace_data['has_liver_cluster'] == True) &\n    (trace_data['liver_nTPM_value'] >= 200)\n]\nprint(f\"TIER 1 (Highest Confidence): {len(tier1)} genes\")\nprint(f\"  Criteria: nTPM present + Cluster present + nTPM ≥ 200\")\nprint(f\"  Recommended for: Primary liver-specific protein candidates\")\n# Tier 2: High confidence\ntier2 = trace_data[",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "tier2",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "tier2 = trace_data[\n    (trace_data['has_liver_in_ntpm'] == True) &\n    (trace_data['has_liver_cluster'] == True) &\n    (trace_data['liver_nTPM_value'] >= 50) &\n    (~trace_data.index.isin(tier1.index))\n]\nprint(f\"\\nTIER 2 (High Confidence): {len(tier2)} genes\")\nprint(f\"  Criteria: nTPM present + Cluster present + nTPM ≥ 50\")\nprint(f\"  Recommended for: Secondary liver-specific candidates\")\n# Tier 3: Medium confidence",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "tier3",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "tier3 = trace_data[\n    (trace_data['has_liver_in_ntpm'] == True) &\n    (trace_data['has_liver_cluster'] == True) &\n    (~trace_data.index.isin(tier1.index)) &\n    (~trace_data.index.isin(tier2.index))\n]\nprint(f\"\\nTIER 3 (Medium Confidence): {len(tier3)} genes\")\nprint(f\"  Criteria: nTPM present + Cluster present (any nTPM value)\")\nprint(f\"  Recommended for: Potential liver-associated proteins\")\n# Tier 4: Exploratory",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "tier4",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "tier4 = trace_data[\n    (trace_data['Classification'] == 'liver protein (all 3)') &\n    (~trace_data.index.isin(tier1.index)) &\n    (~trace_data.index.isin(tier2.index)) &\n    (~trace_data.index.isin(tier3.index))\n]\nprint(f\"\\nTIER 4 (Exploratory): {len(tier4)} genes\")\nprint(f\"  Criteria: All 3 criteria met but low nTPM OR enrichment-based\")\nprint(f\"  Recommended for: Exploratory validation studies\")\n# Save tier assignments",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "trace_data['recommended_tier']",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "trace_data['recommended_tier'] = 'Not recommended'\ntrace_data.loc[tier1.index, 'recommended_tier'] = 'Tier 1 (Highest)'\ntrace_data.loc[tier2.index, 'recommended_tier'] = 'Tier 2 (High)'\ntrace_data.loc[tier3.index, 'recommended_tier'] = 'Tier 3 (Medium)'\ntrace_data.loc[tier4.index, 'recommended_tier'] = 'Tier 4 (Exploratory)'\n# Save results\noutput_file = 'Trace/classification_strategy_analysis.csv'\ntrace_data.to_csv(output_file, index=False)\nprint(f\"\\n\\nDetailed analysis saved to: {output_file}\")\n# Save tier-specific gene lists",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "output_file",
        "kind": 5,
        "importPath": "advanced_analysis.analyze_classification_strategy",
        "description": "advanced_analysis.analyze_classification_strategy",
        "peekOfCode": "output_file = 'Trace/classification_strategy_analysis.csv'\ntrace_data.to_csv(output_file, index=False)\nprint(f\"\\n\\nDetailed analysis saved to: {output_file}\")\n# Save tier-specific gene lists\nfor tier_name, tier_df in [('tier1', tier1), ('tier2', tier2), ('tier3', tier3), ('tier4', tier4)]:\n    if len(tier_df) > 0:\n        tier_file = f'Trace/{tier_name}_high_confidence_genes.csv'\n        tier_df[['Gene', 'liver_nTPM_value', 'Classification', 'confidence_score']].to_csv(tier_file, index=False)\n        print(f\"  {tier_name} genes saved to: {tier_file}\")\nprint(\"\\n\" + \"=\"*80)",
        "detail": "advanced_analysis.analyze_classification_strategy",
        "documentation": {}
    },
    {
        "label": "trace_data",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data = pd.read_csv('Trace/classification_strategy_analysis.csv')\n# Use has_liver_in_ntpm column (already exists in file)\n# Fallback: create combined nTPM column if not exists\nif 'has_liver_in_ntpm' in trace_data.columns:\n    trace_data['has_liver_nTPM'] = trace_data['has_liver_in_ntpm']\nelse:\n    trace_data['has_liver_nTPM'] = (trace_data.get('has_liver_nTPM_high', pd.Series([False]*len(trace_data))) == True) | (trace_data.get('has_liver_nTPM_low', pd.Series([False]*len(trace_data))) == True)\n# Define known liver markers as ground truth\nknown_liver_markers = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1', 'FGA', 'FGB', 'FGG',",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "known_liver_markers",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "known_liver_markers = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1', 'FGA', 'FGB', 'FGG',\n    'CYP3A4', 'CYP2E1', 'FABP1', 'ALDOB', 'ORM1', 'ORM2', 'GC', 'TF',\n    'APOH', 'APOE', 'CRP', 'SAA1', 'SAA2', 'RBP4', 'AMBP', 'SELENOP',\n    'HRG', 'F2', 'FTL', 'AHSG', 'C3', 'HPX', 'VTN', 'ITIH4', 'ITIH3',\n    'FETUB', 'KNG1', 'SERPINC1', 'SERPIND1', 'F9', 'F10', 'F11',\n    'CYP1A2', 'CYP2A6', 'CYP2C8', 'CYP2C9', 'CYP2D6',\n    'UGT1A1', 'UGT2B7', 'GSTA1', 'GSTA2', 'G6PC', 'PCK1'\n]\n# Create ground truth labels",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['is_known_liver']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['is_known_liver'] = trace_data['Gene'].isin(known_liver_markers).astype(int)\nknown_count = trace_data['is_known_liver'].sum()\nprint(f\"\\nKnown liver markers in dataset: {known_count}\")\nprint(f\"Total genes: {len(trace_data)}\")\n# Create binary predictions based on different criteria\n# We'll test multiple classification strategies\n# Strategy 1: Confidence score threshold\ntrace_data['pred_confidence'] = (trace_data['confidence_score'] >= 60).astype(int)\n# Strategy 2: nTPM thresholds (different values)\ntrace_data['pred_ntpm_0'] = (trace_data['liver_nTPM_value'] >= 0).astype(int)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "known_count",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "known_count = trace_data['is_known_liver'].sum()\nprint(f\"\\nKnown liver markers in dataset: {known_count}\")\nprint(f\"Total genes: {len(trace_data)}\")\n# Create binary predictions based on different criteria\n# We'll test multiple classification strategies\n# Strategy 1: Confidence score threshold\ntrace_data['pred_confidence'] = (trace_data['confidence_score'] >= 60).astype(int)\n# Strategy 2: nTPM thresholds (different values)\ntrace_data['pred_ntpm_0'] = (trace_data['liver_nTPM_value'] >= 0).astype(int)\ntrace_data['pred_ntpm_0'] = trace_data['pred_ntpm_0'].fillna(0)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_confidence']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_confidence'] = (trace_data['confidence_score'] >= 60).astype(int)\n# Strategy 2: nTPM thresholds (different values)\ntrace_data['pred_ntpm_0'] = (trace_data['liver_nTPM_value'] >= 0).astype(int)\ntrace_data['pred_ntpm_0'] = trace_data['pred_ntpm_0'].fillna(0)\ntrace_data['pred_ntpm_10'] = (trace_data['liver_nTPM_value'] >= 10).astype(int)\ntrace_data['pred_ntpm_10'] = trace_data['pred_ntpm_10'].fillna(0)\n# Strategy 3: Multi-criteria (2 or more)\ntrace_data['criteria_count'] = (\n    trace_data['has_liver_nTPM'].fillna(False).astype(int) +\n    trace_data['has_liver_cluster'].fillna(False).astype(int) +",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_ntpm_0']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_ntpm_0'] = (trace_data['liver_nTPM_value'] >= 0).astype(int)\ntrace_data['pred_ntpm_0'] = trace_data['pred_ntpm_0'].fillna(0)\ntrace_data['pred_ntpm_10'] = (trace_data['liver_nTPM_value'] >= 10).astype(int)\ntrace_data['pred_ntpm_10'] = trace_data['pred_ntpm_10'].fillna(0)\n# Strategy 3: Multi-criteria (2 or more)\ntrace_data['criteria_count'] = (\n    trace_data['has_liver_nTPM'].fillna(False).astype(int) +\n    trace_data['has_liver_cluster'].fillna(False).astype(int) +\n    trace_data['has_liver_enrichment'].fillna(False).astype(int)\n)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_ntpm_0']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_ntpm_0'] = trace_data['pred_ntpm_0'].fillna(0)\ntrace_data['pred_ntpm_10'] = (trace_data['liver_nTPM_value'] >= 10).astype(int)\ntrace_data['pred_ntpm_10'] = trace_data['pred_ntpm_10'].fillna(0)\n# Strategy 3: Multi-criteria (2 or more)\ntrace_data['criteria_count'] = (\n    trace_data['has_liver_nTPM'].fillna(False).astype(int) +\n    trace_data['has_liver_cluster'].fillna(False).astype(int) +\n    trace_data['has_liver_enrichment'].fillna(False).astype(int)\n)\ntrace_data['pred_multicriteria'] = (trace_data['criteria_count'] >= 2).astype(int)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_ntpm_10']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_ntpm_10'] = (trace_data['liver_nTPM_value'] >= 10).astype(int)\ntrace_data['pred_ntpm_10'] = trace_data['pred_ntpm_10'].fillna(0)\n# Strategy 3: Multi-criteria (2 or more)\ntrace_data['criteria_count'] = (\n    trace_data['has_liver_nTPM'].fillna(False).astype(int) +\n    trace_data['has_liver_cluster'].fillna(False).astype(int) +\n    trace_data['has_liver_enrichment'].fillna(False).astype(int)\n)\ntrace_data['pred_multicriteria'] = (trace_data['criteria_count'] >= 2).astype(int)\n# Strategy 4: Tier 1 classification",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_ntpm_10']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_ntpm_10'] = trace_data['pred_ntpm_10'].fillna(0)\n# Strategy 3: Multi-criteria (2 or more)\ntrace_data['criteria_count'] = (\n    trace_data['has_liver_nTPM'].fillna(False).astype(int) +\n    trace_data['has_liver_cluster'].fillna(False).astype(int) +\n    trace_data['has_liver_enrichment'].fillna(False).astype(int)\n)\ntrace_data['pred_multicriteria'] = (trace_data['criteria_count'] >= 2).astype(int)\n# Strategy 4: Tier 1 classification\ntrace_data['pred_tier1'] = (trace_data['recommended_tier'] == 'Tier 1 (Highest)').astype(int)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['criteria_count']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['criteria_count'] = (\n    trace_data['has_liver_nTPM'].fillna(False).astype(int) +\n    trace_data['has_liver_cluster'].fillna(False).astype(int) +\n    trace_data['has_liver_enrichment'].fillna(False).astype(int)\n)\ntrace_data['pred_multicriteria'] = (trace_data['criteria_count'] >= 2).astype(int)\n# Strategy 4: Tier 1 classification\ntrace_data['pred_tier1'] = (trace_data['recommended_tier'] == 'Tier 1 (Highest)').astype(int)\n# Strategy 5: nTPM + cluster\ntrace_data['pred_ntpm_cluster'] = (",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_multicriteria']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_multicriteria'] = (trace_data['criteria_count'] >= 2).astype(int)\n# Strategy 4: Tier 1 classification\ntrace_data['pred_tier1'] = (trace_data['recommended_tier'] == 'Tier 1 (Highest)').astype(int)\n# Strategy 5: nTPM + cluster\ntrace_data['pred_ntpm_cluster'] = (\n    (trace_data['has_liver_nTPM'] == True) &\n    (trace_data['has_liver_cluster'] == True)\n).astype(int)\n# Create figure with multiple subplots\nfig = plt.figure(figsize=(20, 13))",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_tier1']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_tier1'] = (trace_data['recommended_tier'] == 'Tier 1 (Highest)').astype(int)\n# Strategy 5: nTPM + cluster\ntrace_data['pred_ntpm_cluster'] = (\n    (trace_data['has_liver_nTPM'] == True) &\n    (trace_data['has_liver_cluster'] == True)\n).astype(int)\n# Create figure with multiple subplots\nfig = plt.figure(figsize=(20, 13))\n# ============================================================================\n# 1. ROC Curves Comparison (Top Left)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "trace_data['pred_ntpm_cluster']",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "trace_data['pred_ntpm_cluster'] = (\n    (trace_data['has_liver_nTPM'] == True) &\n    (trace_data['has_liver_cluster'] == True)\n).astype(int)\n# Create figure with multiple subplots\nfig = plt.figure(figsize=(20, 13))\n# ============================================================================\n# 1. ROC Curves Comparison (Top Left)\n# ============================================================================\nax1 = plt.subplot(2, 3, 1)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "fig",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "fig = plt.figure(figsize=(20, 13))\n# ============================================================================\n# 1. ROC Curves Comparison (Top Left)\n# ============================================================================\nax1 = plt.subplot(2, 3, 1)\nstrategies = {\n    'Confidence Score ≥60': ('confidence_score', trace_data['confidence_score'].fillna(0)),\n    'nTPM Threshold ≥0 (any nTPM)': ('pred_ntpm_0', trace_data['liver_nTPM_value'].fillna(-1).apply(lambda x: max(0, x))),\n    'nTPM Threshold ≥10': ('pred_ntpm_10', trace_data['liver_nTPM_value'].fillna(0)),\n    'Multi-Criteria (≥2)': ('criteria_count', trace_data['criteria_count']),",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ax1",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ax1 = plt.subplot(2, 3, 1)\nstrategies = {\n    'Confidence Score ≥60': ('confidence_score', trace_data['confidence_score'].fillna(0)),\n    'nTPM Threshold ≥0 (any nTPM)': ('pred_ntpm_0', trace_data['liver_nTPM_value'].fillna(-1).apply(lambda x: max(0, x))),\n    'nTPM Threshold ≥10': ('pred_ntpm_10', trace_data['liver_nTPM_value'].fillna(0)),\n    'Multi-Criteria (≥2)': ('criteria_count', trace_data['criteria_count']),\n    'nTPM+Cluster (any nTPM)': ('pred_ntpm_cluster', trace_data['pred_ntpm_cluster']),\n    'nTPM+Cluster (≥200)': ('pred_tier1', trace_data['pred_tier1'])\n}\ncolors = ['#FF6B6B', '#4ECDC4', '#A569BD', '#FFE66D', '#95E1D3', '#FF8C42']",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "strategies",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "strategies = {\n    'Confidence Score ≥60': ('confidence_score', trace_data['confidence_score'].fillna(0)),\n    'nTPM Threshold ≥0 (any nTPM)': ('pred_ntpm_0', trace_data['liver_nTPM_value'].fillna(-1).apply(lambda x: max(0, x))),\n    'nTPM Threshold ≥10': ('pred_ntpm_10', trace_data['liver_nTPM_value'].fillna(0)),\n    'Multi-Criteria (≥2)': ('criteria_count', trace_data['criteria_count']),\n    'nTPM+Cluster (any nTPM)': ('pred_ntpm_cluster', trace_data['pred_ntpm_cluster']),\n    'nTPM+Cluster (≥200)': ('pred_tier1', trace_data['pred_tier1'])\n}\ncolors = ['#FF6B6B', '#4ECDC4', '#A569BD', '#FFE66D', '#95E1D3', '#FF8C42']\ny_true = trace_data['is_known_liver']",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "colors",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "colors = ['#FF6B6B', '#4ECDC4', '#A569BD', '#FFE66D', '#95E1D3', '#FF8C42']\ny_true = trace_data['is_known_liver']\nroc_results = {}\nfor (label, (col, scores)), color in zip(strategies.items(), colors):\n    fpr, tpr, thresholds = roc_curve(y_true, scores)\n    roc_auc = auc(fpr, tpr)\n    roc_results[label] = {'fpr': fpr, 'tpr': tpr, 'auc': roc_auc}\n    ax1.plot(fpr, tpr, color=color, linewidth=2.5,\n             label=f'{label} (AUC = {roc_auc:.3f})')\nax1.plot([0, 1], [0, 1], 'k--', linewidth=2, label='Random Classifier')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "y_true",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "y_true = trace_data['is_known_liver']\nroc_results = {}\nfor (label, (col, scores)), color in zip(strategies.items(), colors):\n    fpr, tpr, thresholds = roc_curve(y_true, scores)\n    roc_auc = auc(fpr, tpr)\n    roc_results[label] = {'fpr': fpr, 'tpr': tpr, 'auc': roc_auc}\n    ax1.plot(fpr, tpr, color=color, linewidth=2.5,\n             label=f'{label} (AUC = {roc_auc:.3f})')\nax1.plot([0, 1], [0, 1], 'k--', linewidth=2, label='Random Classifier')\nax1.set_xlabel('False Positive Rate', fontsize=12, fontweight='bold')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "roc_results",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "roc_results = {}\nfor (label, (col, scores)), color in zip(strategies.items(), colors):\n    fpr, tpr, thresholds = roc_curve(y_true, scores)\n    roc_auc = auc(fpr, tpr)\n    roc_results[label] = {'fpr': fpr, 'tpr': tpr, 'auc': roc_auc}\n    ax1.plot(fpr, tpr, color=color, linewidth=2.5,\n             label=f'{label} (AUC = {roc_auc:.3f})')\nax1.plot([0, 1], [0, 1], 'k--', linewidth=2, label='Random Classifier')\nax1.set_xlabel('False Positive Rate', fontsize=12, fontweight='bold')\nax1.set_ylabel('True Positive Rate', fontsize=12, fontweight='bold')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ax2",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ax2 = plt.subplot(2, 3, 2)\nfor (label, (col, scores)), color in zip(strategies.items(), colors):\n    precision, recall, thresholds = precision_recall_curve(y_true, scores)\n    avg_precision = average_precision_score(y_true, scores)\n    ax2.plot(recall, precision, color=color, linewidth=2.5,\n             label=f'{label} (AP = {avg_precision:.3f})')\nax2.set_xlabel('Recall', fontsize=12, fontweight='bold')\nax2.set_ylabel('Precision', fontsize=12, fontweight='bold')\nax2.set_title('Precision-Recall Curves', fontsize=14, fontweight='bold', pad=15)\nax2.legend(loc='upper right', fontsize=8.5, framealpha=0.95)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ax3",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ax3 = plt.subplot(2, 3, 3)\ny_pred_ntpm = trace_data['pred_ntpm_10']\ncm = confusion_matrix(y_true, y_pred_ntpm)\nim = ax3.imshow(cm, cmap='Blues', alpha=0.8)\nax3.set_xticks([0, 1])\nax3.set_yticks([0, 1])\nax3.set_xticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_yticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_xlabel('Predicted', fontsize=12, fontweight='bold')\nax3.set_ylabel('True (Known Markers)', fontsize=12, fontweight='bold')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "y_pred_ntpm",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "y_pred_ntpm = trace_data['pred_ntpm_10']\ncm = confusion_matrix(y_true, y_pred_ntpm)\nim = ax3.imshow(cm, cmap='Blues', alpha=0.8)\nax3.set_xticks([0, 1])\nax3.set_yticks([0, 1])\nax3.set_xticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_yticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_xlabel('Predicted', fontsize=12, fontweight='bold')\nax3.set_ylabel('True (Known Markers)', fontsize=12, fontweight='bold')\nax3.set_title('Confusion Matrix: nTPM Threshold ≥10\\n(Best Overall Performance)', fontsize=13, fontweight='bold', pad=15)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "cm",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "cm = confusion_matrix(y_true, y_pred_ntpm)\nim = ax3.imshow(cm, cmap='Blues', alpha=0.8)\nax3.set_xticks([0, 1])\nax3.set_yticks([0, 1])\nax3.set_xticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_yticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_xlabel('Predicted', fontsize=12, fontweight='bold')\nax3.set_ylabel('True (Known Markers)', fontsize=12, fontweight='bold')\nax3.set_title('Confusion Matrix: nTPM Threshold ≥10\\n(Best Overall Performance)', fontsize=13, fontweight='bold', pad=15)\n# Add text annotations",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "im",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "im = ax3.imshow(cm, cmap='Blues', alpha=0.8)\nax3.set_xticks([0, 1])\nax3.set_yticks([0, 1])\nax3.set_xticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_yticklabels(['Not Liver', 'Liver'], fontsize=11)\nax3.set_xlabel('Predicted', fontsize=12, fontweight='bold')\nax3.set_ylabel('True (Known Markers)', fontsize=12, fontweight='bold')\nax3.set_title('Confusion Matrix: nTPM Threshold ≥10\\n(Best Overall Performance)', fontsize=13, fontweight='bold', pad=15)\n# Add text annotations\nfor i in range(2):",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "cbar",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "cbar = plt.colorbar(im, ax=ax3)\ncbar.set_label('Count', fontsize=10)\n# ============================================================================\n# 4. Performance Metrics Comparison (Bottom Left)\n# ============================================================================\nax4 = plt.subplot(2, 3, 4)\nmetrics_data = []\nfor label, (col, scores) in strategies.items():\n    if label == 'nTPM Threshold ≥0 (any nTPM)':\n        y_pred = trace_data['pred_ntpm_0']",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ax4",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ax4 = plt.subplot(2, 3, 4)\nmetrics_data = []\nfor label, (col, scores) in strategies.items():\n    if label == 'nTPM Threshold ≥0 (any nTPM)':\n        y_pred = trace_data['pred_ntpm_0']\n    elif label == 'nTPM Threshold ≥10':\n        y_pred = trace_data['pred_ntpm_10']\n    elif label == 'Multi-Criteria (≥2)':\n        y_pred = trace_data['pred_multicriteria']\n    elif label == 'nTPM+Cluster (≥200)':",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "metrics_data",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "metrics_data = []\nfor label, (col, scores) in strategies.items():\n    if label == 'nTPM Threshold ≥0 (any nTPM)':\n        y_pred = trace_data['pred_ntpm_0']\n    elif label == 'nTPM Threshold ≥10':\n        y_pred = trace_data['pred_ntpm_10']\n    elif label == 'Multi-Criteria (≥2)':\n        y_pred = trace_data['pred_multicriteria']\n    elif label == 'nTPM+Cluster (≥200)':\n        y_pred = trace_data['pred_tier1']",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "metrics_df",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "metrics_df = pd.DataFrame(metrics_data)\nx = np.arange(len(metrics_df))\nwidth = 0.2\nbars1 = ax4.bar(x - 1.5*width, metrics_df['Sensitivity'], width, label='Sensitivity', color='#FF6B6B', alpha=0.8)\nbars2 = ax4.bar(x - 0.5*width, metrics_df['Specificity'], width, label='Specificity', color='#4ECDC4', alpha=0.8)\nbars3 = ax4.bar(x + 0.5*width, metrics_df['Precision'], width, label='Precision', color='#FFE66D', alpha=0.8)\nbars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "x",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "x = np.arange(len(metrics_df))\nwidth = 0.2\nbars1 = ax4.bar(x - 1.5*width, metrics_df['Sensitivity'], width, label='Sensitivity', color='#FF6B6B', alpha=0.8)\nbars2 = ax4.bar(x - 0.5*width, metrics_df['Specificity'], width, label='Specificity', color='#4ECDC4', alpha=0.8)\nbars3 = ax4.bar(x + 0.5*width, metrics_df['Precision'], width, label='Precision', color='#FFE66D', alpha=0.8)\nbars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)\nax4.set_xticklabels(metrics_df['Strategy'], fontsize=7.5, rotation=0, ha='center')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "width",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "width = 0.2\nbars1 = ax4.bar(x - 1.5*width, metrics_df['Sensitivity'], width, label='Sensitivity', color='#FF6B6B', alpha=0.8)\nbars2 = ax4.bar(x - 0.5*width, metrics_df['Specificity'], width, label='Specificity', color='#4ECDC4', alpha=0.8)\nbars3 = ax4.bar(x + 0.5*width, metrics_df['Precision'], width, label='Precision', color='#FFE66D', alpha=0.8)\nbars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)\nax4.set_xticklabels(metrics_df['Strategy'], fontsize=7.5, rotation=0, ha='center')\nax4.legend(loc='upper left', fontsize=9.5, framealpha=0.95)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "bars1",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "bars1 = ax4.bar(x - 1.5*width, metrics_df['Sensitivity'], width, label='Sensitivity', color='#FF6B6B', alpha=0.8)\nbars2 = ax4.bar(x - 0.5*width, metrics_df['Specificity'], width, label='Specificity', color='#4ECDC4', alpha=0.8)\nbars3 = ax4.bar(x + 0.5*width, metrics_df['Precision'], width, label='Precision', color='#FFE66D', alpha=0.8)\nbars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)\nax4.set_xticklabels(metrics_df['Strategy'], fontsize=7.5, rotation=0, ha='center')\nax4.legend(loc='upper left', fontsize=9.5, framealpha=0.95)\nax4.set_ylim(0, 1.1)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "bars2",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "bars2 = ax4.bar(x - 0.5*width, metrics_df['Specificity'], width, label='Specificity', color='#4ECDC4', alpha=0.8)\nbars3 = ax4.bar(x + 0.5*width, metrics_df['Precision'], width, label='Precision', color='#FFE66D', alpha=0.8)\nbars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)\nax4.set_xticklabels(metrics_df['Strategy'], fontsize=7.5, rotation=0, ha='center')\nax4.legend(loc='upper left', fontsize=9.5, framealpha=0.95)\nax4.set_ylim(0, 1.1)\nax4.grid(axis='y', alpha=0.3)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "bars3",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "bars3 = ax4.bar(x + 0.5*width, metrics_df['Precision'], width, label='Precision', color='#FFE66D', alpha=0.8)\nbars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)\nax4.set_xticklabels(metrics_df['Strategy'], fontsize=7.5, rotation=0, ha='center')\nax4.legend(loc='upper left', fontsize=9.5, framealpha=0.95)\nax4.set_ylim(0, 1.1)\nax4.grid(axis='y', alpha=0.3)\n# ============================================================================",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "bars4",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "bars4 = ax4.bar(x + 1.5*width, metrics_df['F1-Score'], width, label='F1-Score', color='#95E1D3', alpha=0.8)\nax4.set_ylabel('Score', fontsize=12, fontweight='bold')\nax4.set_title('Performance Metrics Comparison', fontsize=14, fontweight='bold', pad=15)\nax4.set_xticks(x)\nax4.set_xticklabels(metrics_df['Strategy'], fontsize=7.5, rotation=0, ha='center')\nax4.legend(loc='upper left', fontsize=9.5, framealpha=0.95)\nax4.set_ylim(0, 1.1)\nax4.grid(axis='y', alpha=0.3)\n# ============================================================================\n# 5. Score Distribution (Bottom Middle)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ax5",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ax5 = plt.subplot(2, 3, 5)\nknown_liver = trace_data[trace_data['is_known_liver'] == 1]['confidence_score']\nnon_liver = trace_data[trace_data['is_known_liver'] == 0]['confidence_score']\nax5.hist(non_liver, bins=30, alpha=0.6, label='Non-liver proteins', color='#E8E8E8', edgecolor='black')\nax5.hist(known_liver, bins=15, alpha=0.8, label='Known liver markers', color='#FF6B6B', edgecolor='black')\nax5.axvline(60, color='red', linestyle='--', linewidth=2.5, label='Threshold = 60')\nax5.set_xlabel('Confidence Score', fontsize=12, fontweight='bold')\nax5.set_ylabel('Frequency', fontsize=12, fontweight='bold')\nax5.set_title('Confidence Score Distribution', fontsize=14, fontweight='bold', pad=15)\nax5.legend(loc='upper right', fontsize=9.5, framealpha=0.95)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "known_liver",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "known_liver = trace_data[trace_data['is_known_liver'] == 1]['confidence_score']\nnon_liver = trace_data[trace_data['is_known_liver'] == 0]['confidence_score']\nax5.hist(non_liver, bins=30, alpha=0.6, label='Non-liver proteins', color='#E8E8E8', edgecolor='black')\nax5.hist(known_liver, bins=15, alpha=0.8, label='Known liver markers', color='#FF6B6B', edgecolor='black')\nax5.axvline(60, color='red', linestyle='--', linewidth=2.5, label='Threshold = 60')\nax5.set_xlabel('Confidence Score', fontsize=12, fontweight='bold')\nax5.set_ylabel('Frequency', fontsize=12, fontweight='bold')\nax5.set_title('Confidence Score Distribution', fontsize=14, fontweight='bold', pad=15)\nax5.legend(loc='upper right', fontsize=9.5, framealpha=0.95)\nax5.grid(axis='y', alpha=0.3)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "non_liver",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "non_liver = trace_data[trace_data['is_known_liver'] == 0]['confidence_score']\nax5.hist(non_liver, bins=30, alpha=0.6, label='Non-liver proteins', color='#E8E8E8', edgecolor='black')\nax5.hist(known_liver, bins=15, alpha=0.8, label='Known liver markers', color='#FF6B6B', edgecolor='black')\nax5.axvline(60, color='red', linestyle='--', linewidth=2.5, label='Threshold = 60')\nax5.set_xlabel('Confidence Score', fontsize=12, fontweight='bold')\nax5.set_ylabel('Frequency', fontsize=12, fontweight='bold')\nax5.set_title('Confidence Score Distribution', fontsize=14, fontweight='bold', pad=15)\nax5.legend(loc='upper right', fontsize=9.5, framealpha=0.95)\nax5.grid(axis='y', alpha=0.3)\n# ============================================================================",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ax6",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ax6 = plt.subplot(2, 3, 6)\nax6.axis('off')\n# Create summary table\nsummary_data = []\nfor label, (col, scores) in strategies.items():\n    roc_auc = roc_results[label]['auc']\n    avg_precision = average_precision_score(y_true, scores)\n    if label == 'nTPM Threshold ≥0 (any nTPM)':\n        y_pred = trace_data['pred_ntpm_0']\n    elif label == 'nTPM Threshold ≥10':",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "summary_data",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "summary_data = []\nfor label, (col, scores) in strategies.items():\n    roc_auc = roc_results[label]['auc']\n    avg_precision = average_precision_score(y_true, scores)\n    if label == 'nTPM Threshold ≥0 (any nTPM)':\n        y_pred = trace_data['pred_ntpm_0']\n    elif label == 'nTPM Threshold ≥10':\n        y_pred = trace_data['pred_ntpm_10']\n    elif label == 'Multi-Criteria (≥2)':\n        y_pred = trace_data['pred_multicriteria']",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "column_labels",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "column_labels = ['Strategy', 'AUC', 'AP', 'TP/P', 'TN/N']\ntable = ax6.table(cellText=summary_data, colLabels=column_labels,\n                  cellLoc='center', loc='center',\n                  colWidths=[0.38, 0.14, 0.14, 0.16, 0.18])\ntable.auto_set_font_size(False)\ntable.set_fontsize(9)\ntable.scale(1, 2.8)\n# Style header\nfor i in range(len(column_labels)):\n    cell = table[(0, i)]",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "table",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "table = ax6.table(cellText=summary_data, colLabels=column_labels,\n                  cellLoc='center', loc='center',\n                  colWidths=[0.38, 0.14, 0.14, 0.16, 0.18])\ntable.auto_set_font_size(False)\ntable.set_fontsize(9)\ntable.scale(1, 2.8)\n# Style header\nfor i in range(len(column_labels)):\n    cell = table[(0, i)]\n    cell.set_facecolor('#4A90E2')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "row_colors",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "row_colors = colors\nfor i in range(len(summary_data)):\n    for j in range(len(column_labels)):\n        cell = table[(i+1, j)]\n        cell.set_facecolor(row_colors[i])\n        cell.set_alpha(0.3)\n        cell.set_text_props(fontsize=9)\nax6.set_title('Performance Summary', fontsize=14, fontweight='bold', pad=25)\nplt.tight_layout()\nplt.savefig('output/roc_auc_analysis.png', dpi=300, bbox_inches='tight')",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "ap_scores",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "ap_scores = {}\nfor label, (col, scores) in strategies.items():\n    ap_scores[label] = average_precision_score(y_true, scores)\n# Find best strategies\nbest_auc = max(roc_results.items(), key=lambda x: x[1]['auc'])\nbest_ap = max(ap_scores.items(), key=lambda x: x[1])\nprint(f\"\\nBest by AUC-ROC: {best_auc[0]}\")\nprint(f\"  AUC-ROC: {best_auc[1]['auc']:.3f}\")\nprint(f\"\\nBest by AP (Average Precision): {best_ap[0]}\")\nprint(f\"  AP: {best_ap[1]:.3f}\")",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "best_auc",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "best_auc = max(roc_results.items(), key=lambda x: x[1]['auc'])\nbest_ap = max(ap_scores.items(), key=lambda x: x[1])\nprint(f\"\\nBest by AUC-ROC: {best_auc[0]}\")\nprint(f\"  AUC-ROC: {best_auc[1]['auc']:.3f}\")\nprint(f\"\\nBest by AP (Average Precision): {best_ap[0]}\")\nprint(f\"  AP: {best_ap[1]:.3f}\")\n# Combined recommendation\nprint(\"\\n\" + \"-\"*80)\nprint(\"STRATEGY RECOMMENDATIONS BY USE CASE:\")\nprint(\"-\"*80)",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "best_ap",
        "kind": 5,
        "importPath": "advanced_analysis.generate_roc_curve",
        "description": "advanced_analysis.generate_roc_curve",
        "peekOfCode": "best_ap = max(ap_scores.items(), key=lambda x: x[1])\nprint(f\"\\nBest by AUC-ROC: {best_auc[0]}\")\nprint(f\"  AUC-ROC: {best_auc[1]['auc']:.3f}\")\nprint(f\"\\nBest by AP (Average Precision): {best_ap[0]}\")\nprint(f\"  AP: {best_ap[1]:.3f}\")\n# Combined recommendation\nprint(\"\\n\" + \"-\"*80)\nprint(\"STRATEGY RECOMMENDATIONS BY USE CASE:\")\nprint(\"-\"*80)\nprint(\"\\nFor liver protein classification, we recommend:\")",
        "detail": "advanced_analysis.generate_roc_curve",
        "documentation": {}
    },
    {
        "label": "extract_liver_ntpm",
        "kind": 2,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "def extract_liver_ntpm(text):\n    \"\"\"Extract numerical liver nTPM value from text.\"\"\"\n    if pd.isna(text) or text == '':\n        return None\n    pattern = r'liver:\\s*(\\d+\\.?\\d*)'\n    match = re.search(pattern, str(text).lower())\n    if match:\n        return float(match.group(1))\n    return None\ndef classify_with_threshold(merged_data, threshold):",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "classify_with_threshold",
        "kind": 2,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "def classify_with_threshold(merged_data, threshold):\n    \"\"\"\n    Classify liver proteins using a specific nTPM threshold.\n    Args:\n        merged_data: DataFrame with merged gene and protein atlas data\n        threshold: nTPM threshold value to use\n    Returns:\n        DataFrame with classification results\n    \"\"\"\n    df = merged_data.copy()",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "calculate_metrics",
        "kind": 2,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "def calculate_metrics(df, threshold):\n    \"\"\"\n    Calculate performance metrics for a specific threshold.\n    Returns:\n        dict with various metrics\n    \"\"\"\n    metrics = {\n        'threshold': threshold,\n    }\n    # Count genes in different categories",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "THRESHOLDS_TO_TEST",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "THRESHOLDS_TO_TEST = [10, 20, 50, 100, 150, 200, 300]\n# Output file\nTHRESHOLD_ANALYSIS_OUTPUT = OUTPUT_DIR / 'ntpm_threshold_optimization.png'\nTHRESHOLD_RESULTS_CSV = TRACE_DIR / 'threshold_optimization_results.csv'\n# =============================================================================\n# HELPER FUNCTIONS\n# =============================================================================\ndef extract_liver_ntpm(text):\n    \"\"\"Extract numerical liver nTPM value from text.\"\"\"\n    if pd.isna(text) or text == '':",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "THRESHOLD_ANALYSIS_OUTPUT",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "THRESHOLD_ANALYSIS_OUTPUT = OUTPUT_DIR / 'ntpm_threshold_optimization.png'\nTHRESHOLD_RESULTS_CSV = TRACE_DIR / 'threshold_optimization_results.csv'\n# =============================================================================\n# HELPER FUNCTIONS\n# =============================================================================\ndef extract_liver_ntpm(text):\n    \"\"\"Extract numerical liver nTPM value from text.\"\"\"\n    if pd.isna(text) or text == '':\n        return None\n    pattern = r'liver:\\s*(\\d+\\.?\\d*)'",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "THRESHOLD_RESULTS_CSV",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "THRESHOLD_RESULTS_CSV = TRACE_DIR / 'threshold_optimization_results.csv'\n# =============================================================================\n# HELPER FUNCTIONS\n# =============================================================================\ndef extract_liver_ntpm(text):\n    \"\"\"Extract numerical liver nTPM value from text.\"\"\"\n    if pd.isna(text) or text == '':\n        return None\n    pattern = r'liver:\\s*(\\d+\\.?\\d*)'\n    match = re.search(pattern, str(text).lower())",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "csv_files",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "csv_files = list(INPUT_DIR.glob(CSV_PATTERN))\nif not csv_files:\n    print(f\"❌ No CSV files found in {INPUT_DIR}\")\n    sys.exit(1)\ngene_data = pd.read_csv(csv_files[0])\nprotein_atlas = pd.read_csv(PROTEIN_ATLAS_FILE, sep='\\t')\nprint(f\"  Gene data: {len(gene_data)} genes\")\nprint(f\"  Protein atlas: {len(protein_atlas)} genes\")\n# Merge datasets\nprint(\"\\n[2/4] Merging datasets...\")",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "gene_data",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "gene_data = pd.read_csv(csv_files[0])\nprotein_atlas = pd.read_csv(PROTEIN_ATLAS_FILE, sep='\\t')\nprint(f\"  Gene data: {len(gene_data)} genes\")\nprint(f\"  Protein atlas: {len(protein_atlas)} genes\")\n# Merge datasets\nprint(\"\\n[2/4] Merging datasets...\")\nmerged_data = gene_data.merge(\n    protein_atlas[['Gene', 'RNA tissue specific nTPM', 'Tissue expression cluster', 'RNA tissue cell type enrichment']],\n    on='Gene',\n    how='left'",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "protein_atlas",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "protein_atlas = pd.read_csv(PROTEIN_ATLAS_FILE, sep='\\t')\nprint(f\"  Gene data: {len(gene_data)} genes\")\nprint(f\"  Protein atlas: {len(protein_atlas)} genes\")\n# Merge datasets\nprint(\"\\n[2/4] Merging datasets...\")\nmerged_data = gene_data.merge(\n    protein_atlas[['Gene', 'RNA tissue specific nTPM', 'Tissue expression cluster', 'RNA tissue cell type enrichment']],\n    on='Gene',\n    how='left'\n)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "merged_data",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "merged_data = gene_data.merge(\n    protein_atlas[['Gene', 'RNA tissue specific nTPM', 'Tissue expression cluster', 'RNA tissue cell type enrichment']],\n    on='Gene',\n    how='left'\n)\n# Extract liver nTPM values\nmerged_data['liver_nTPM_value'] = merged_data['RNA tissue specific nTPM'].apply(extract_liver_ntpm)\nmerged_data['has_liver_in_ntpm'] = merged_data['RNA tissue specific nTPM'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "merged_data['liver_nTPM_value']",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "merged_data['liver_nTPM_value'] = merged_data['RNA tissue specific nTPM'].apply(extract_liver_ntpm)\nmerged_data['has_liver_in_ntpm'] = merged_data['RNA tissue specific nTPM'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\nprint(f\"  Merged: {len(merged_data)} records\")\nprint(f\"  Genes with liver nTPM values: {merged_data['liver_nTPM_value'].notna().sum()}\")\n# Test different thresholds\nprint(f\"\\n[3/4] Testing {len(THRESHOLDS_TO_TEST)} different thresholds...\")\nresults = []\nfor threshold in THRESHOLDS_TO_TEST:",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_in_ntpm']",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "merged_data['has_liver_in_ntpm'] = merged_data['RNA tissue specific nTPM'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\nprint(f\"  Merged: {len(merged_data)} records\")\nprint(f\"  Genes with liver nTPM values: {merged_data['liver_nTPM_value'].notna().sum()}\")\n# Test different thresholds\nprint(f\"\\n[3/4] Testing {len(THRESHOLDS_TO_TEST)} different thresholds...\")\nresults = []\nfor threshold in THRESHOLDS_TO_TEST:\n    print(f\"\\n  Testing threshold: {threshold}\")",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_cluster']",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "merged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\nprint(f\"  Merged: {len(merged_data)} records\")\nprint(f\"  Genes with liver nTPM values: {merged_data['liver_nTPM_value'].notna().sum()}\")\n# Test different thresholds\nprint(f\"\\n[3/4] Testing {len(THRESHOLDS_TO_TEST)} different thresholds...\")\nresults = []\nfor threshold in THRESHOLDS_TO_TEST:\n    print(f\"\\n  Testing threshold: {threshold}\")\n    # Classify with this threshold",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_enrichment']",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "merged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\nprint(f\"  Merged: {len(merged_data)} records\")\nprint(f\"  Genes with liver nTPM values: {merged_data['liver_nTPM_value'].notna().sum()}\")\n# Test different thresholds\nprint(f\"\\n[3/4] Testing {len(THRESHOLDS_TO_TEST)} different thresholds...\")\nresults = []\nfor threshold in THRESHOLDS_TO_TEST:\n    print(f\"\\n  Testing threshold: {threshold}\")\n    # Classify with this threshold\n    classified_data = classify_with_threshold(merged_data, threshold)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "results",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "results = []\nfor threshold in THRESHOLDS_TO_TEST:\n    print(f\"\\n  Testing threshold: {threshold}\")\n    # Classify with this threshold\n    classified_data = classify_with_threshold(merged_data, threshold)\n    # Calculate metrics\n    metrics = calculate_metrics(classified_data, threshold)\n    results.append(metrics)\n    print(f\"    Liver genes: {metrics['liver_genes']} ({metrics['liver_percentage']:.1f}%)\")\n    print(f\"    High confidence: {metrics['high_conf_total']} (≥{threshold}: {metrics['high_conf_ntpm_high']}, <{threshold}: {metrics['high_conf_ntpm_low']})\")",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "results_df",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "results_df = pd.DataFrame(results)\n# Save results\nresults_df.to_csv(THRESHOLD_RESULTS_CSV, index=False)\nprint(f\"\\n✓ Results saved to: {THRESHOLD_RESULTS_CSV}\")\n# Create visualization\nprint(\"\\n[4/4] Creating visualization...\")\nfig = plt.figure(figsize=(20, 12))\nfig.suptitle('nTPM Threshold Optimization Analysis', fontsize=20, fontweight='bold', y=0.98)\n# Plot 1: Total liver genes identified\nax1 = plt.subplot(2, 3, 1)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "fig",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "fig = plt.figure(figsize=(20, 12))\nfig.suptitle('nTPM Threshold Optimization Analysis', fontsize=20, fontweight='bold', y=0.98)\n# Plot 1: Total liver genes identified\nax1 = plt.subplot(2, 3, 1)\nax1.plot(results_df['threshold'], results_df['liver_genes'], 'o-', linewidth=2, markersize=8, color='#2E86AB')\nax1.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax1.set_ylabel('Number of Liver Genes', fontsize=12, fontweight='bold')\nax1.set_title('Total Liver Genes Identified', fontsize=14, fontweight='bold')\nax1.grid(True, alpha=0.3)\nfor i, row in results_df.iterrows():",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "ax1",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "ax1 = plt.subplot(2, 3, 1)\nax1.plot(results_df['threshold'], results_df['liver_genes'], 'o-', linewidth=2, markersize=8, color='#2E86AB')\nax1.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax1.set_ylabel('Number of Liver Genes', fontsize=12, fontweight='bold')\nax1.set_title('Total Liver Genes Identified', fontsize=14, fontweight='bold')\nax1.grid(True, alpha=0.3)\nfor i, row in results_df.iterrows():\n    ax1.text(row['threshold'], row['liver_genes'], f\"{row['liver_genes']}\",\n             ha='center', va='bottom', fontsize=9)\n# Plot 2: High confidence genes",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "ax2",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "ax2 = plt.subplot(2, 3, 2)\nax2.plot(results_df['threshold'], results_df['high_conf_total'], 'o-', linewidth=2, markersize=8, color='#A23B72', label='Total')\nax2.plot(results_df['threshold'], results_df['high_conf_ntpm_high'], 's--', linewidth=2, markersize=6, color='#F18F01', label='nTPM ≥ threshold')\nax2.plot(results_df['threshold'], results_df['high_conf_ntpm_low'], '^--', linewidth=2, markersize=6, color='#C73E1D', label='nTPM < threshold')\nax2.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax2.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax2.set_title('High Confidence Genes (3 Criteria)', fontsize=14, fontweight='bold')\nax2.legend(fontsize=10)\nax2.grid(True, alpha=0.3)\n# Plot 3: Known liver markers coverage",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "ax3",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "ax3 = plt.subplot(2, 3, 3)\nax3.plot(results_df['threshold'], results_df['known_markers_coverage'], 'o-', linewidth=2, markersize=8, color='#16DB93', label='Any category')\nax3.plot(results_df['threshold'], results_df['known_markers_high_conf_rate'], 's-', linewidth=2, markersize=8, color='#048A81', label='High confidence')\nax3.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax3.set_ylabel('Coverage (%)', fontsize=12, fontweight='bold')\nax3.set_title(f'Known Liver Markers Coverage (n={len(KNOWN_LIVER_MARKERS)})', fontsize=14, fontweight='bold')\nax3.legend(fontsize=10)\nax3.grid(True, alpha=0.3)\nax3.axhline(y=100, color='gray', linestyle=':', alpha=0.5)\n# Plot 4: nTPM distribution balance",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "ax4",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "ax4 = plt.subplot(2, 3, 4)\nwidth = 0.35\nx = np.arange(len(results_df))\nax4.bar(x - width/2, results_df['ntpm_high_count'], width, label='nTPM ≥ threshold', color='#FF6B6B', alpha=0.8)\nax4.bar(x + width/2, results_df['ntpm_low_count'], width, label='nTPM < threshold', color='#4169E1', alpha=0.8)\nax4.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax4.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax4.set_title('nTPM Value Distribution by Threshold', fontsize=14, fontweight='bold')\nax4.set_xticks(x)\nax4.set_xticklabels(results_df['threshold'])",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "width",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "width = 0.35\nx = np.arange(len(results_df))\nax4.bar(x - width/2, results_df['ntpm_high_count'], width, label='nTPM ≥ threshold', color='#FF6B6B', alpha=0.8)\nax4.bar(x + width/2, results_df['ntpm_low_count'], width, label='nTPM < threshold', color='#4169E1', alpha=0.8)\nax4.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax4.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax4.set_title('nTPM Value Distribution by Threshold', fontsize=14, fontweight='bold')\nax4.set_xticks(x)\nax4.set_xticklabels(results_df['threshold'])\nax4.legend(fontsize=10)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "x",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "x = np.arange(len(results_df))\nax4.bar(x - width/2, results_df['ntpm_high_count'], width, label='nTPM ≥ threshold', color='#FF6B6B', alpha=0.8)\nax4.bar(x + width/2, results_df['ntpm_low_count'], width, label='nTPM < threshold', color='#4169E1', alpha=0.8)\nax4.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax4.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax4.set_title('nTPM Value Distribution by Threshold', fontsize=14, fontweight='bold')\nax4.set_xticks(x)\nax4.set_xticklabels(results_df['threshold'])\nax4.legend(fontsize=10)\nax4.grid(True, alpha=0.3, axis='y')",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "ax5",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "ax5 = plt.subplot(2, 3, 5)\nwidth = 0.25\nx = np.arange(len(results_df))\nax5.bar(x - width, results_df['high_conf_total'], width, label='High (3 criteria)', color='#27AE60', alpha=0.8)\nax5.bar(x, results_df['med_conf_total'], width, label='Medium (2 criteria)', color='#F39C12', alpha=0.8)\nax5.bar(x + width, results_df['low_conf_total'], width, label='Low (1 criterion)', color='#E74C3C', alpha=0.8)\nax5.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax5.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax5.set_title('Confidence Distribution', fontsize=14, fontweight='bold')\nax5.set_xticks(x)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "width",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "width = 0.25\nx = np.arange(len(results_df))\nax5.bar(x - width, results_df['high_conf_total'], width, label='High (3 criteria)', color='#27AE60', alpha=0.8)\nax5.bar(x, results_df['med_conf_total'], width, label='Medium (2 criteria)', color='#F39C12', alpha=0.8)\nax5.bar(x + width, results_df['low_conf_total'], width, label='Low (1 criterion)', color='#E74C3C', alpha=0.8)\nax5.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax5.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax5.set_title('Confidence Distribution', fontsize=14, fontweight='bold')\nax5.set_xticks(x)\nax5.set_xticklabels(results_df['threshold'])",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "x",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "x = np.arange(len(results_df))\nax5.bar(x - width, results_df['high_conf_total'], width, label='High (3 criteria)', color='#27AE60', alpha=0.8)\nax5.bar(x, results_df['med_conf_total'], width, label='Medium (2 criteria)', color='#F39C12', alpha=0.8)\nax5.bar(x + width, results_df['low_conf_total'], width, label='Low (1 criterion)', color='#E74C3C', alpha=0.8)\nax5.set_xlabel('nTPM Threshold', fontsize=12, fontweight='bold')\nax5.set_ylabel('Number of Genes', fontsize=12, fontweight='bold')\nax5.set_title('Confidence Distribution', fontsize=14, fontweight='bold')\nax5.set_xticks(x)\nax5.set_xticklabels(results_df['threshold'])\nax5.legend(fontsize=10)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "ax6",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "ax6 = plt.subplot(2, 3, 6)\nax6.axis('off')\n# Create summary table\nsummary_data = []\nfor _, row in results_df.iterrows():\n    summary_data.append([\n        f\"{row['threshold']}\",\n        f\"{row['liver_genes']}\",\n        f\"{row['high_conf_total']}\",\n        f\"{row['known_markers_found']}/{row['known_markers_total']}\",",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "summary_data",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "summary_data = []\nfor _, row in results_df.iterrows():\n    summary_data.append([\n        f\"{row['threshold']}\",\n        f\"{row['liver_genes']}\",\n        f\"{row['high_conf_total']}\",\n        f\"{row['known_markers_found']}/{row['known_markers_total']}\",\n        f\"{row['known_markers_high_conf']}\",\n    ])\ntable = ax6.table(cellText=summary_data,",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "table",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "table = ax6.table(cellText=summary_data,\n                  colLabels=['Threshold', 'Liver\\nGenes', 'High\\nConf', 'Known\\nMarkers', 'Markers\\nin High'],\n                  cellLoc='center',\n                  loc='center',\n                  bbox=[0, 0, 1, 1])\ntable.auto_set_font_size(False)\ntable.set_fontsize(10)\ntable.scale(1, 2)\n# Color header\nfor i in range(5):",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "best_by_markers",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "best_by_markers = results_df.loc[results_df['known_markers_coverage'].idxmax()]\nbest_by_high_conf = results_df.loc[results_df['known_markers_high_conf_rate'].idxmax()]\nprint(f\"\\nBest threshold by known markers coverage: {best_by_markers['threshold']}\")\nprint(f\"  - Coverage: {best_by_markers['known_markers_coverage']:.1f}%\")\nprint(f\"  - High confidence markers: {best_by_markers['known_markers_high_conf']}\")\nprint(f\"  - Total liver genes: {best_by_markers['liver_genes']}\")\nprint(f\"\\nBest threshold by known markers in high confidence: {best_by_high_conf['threshold']}\")\nprint(f\"  - High confidence markers: {best_by_high_conf['known_markers_high_conf']} ({best_by_high_conf['known_markers_high_conf_rate']:.1f}%)\")\nprint(f\"  - Total coverage: {best_by_high_conf['known_markers_coverage']:.1f}%\")\nprint(f\"  - Total liver genes: {best_by_high_conf['liver_genes']}\")",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "best_by_high_conf",
        "kind": 5,
        "importPath": "advanced_analysis.optimize_ntpm_threshold",
        "description": "advanced_analysis.optimize_ntpm_threshold",
        "peekOfCode": "best_by_high_conf = results_df.loc[results_df['known_markers_high_conf_rate'].idxmax()]\nprint(f\"\\nBest threshold by known markers coverage: {best_by_markers['threshold']}\")\nprint(f\"  - Coverage: {best_by_markers['known_markers_coverage']:.1f}%\")\nprint(f\"  - High confidence markers: {best_by_markers['known_markers_high_conf']}\")\nprint(f\"  - Total liver genes: {best_by_markers['liver_genes']}\")\nprint(f\"\\nBest threshold by known markers in high confidence: {best_by_high_conf['threshold']}\")\nprint(f\"  - High confidence markers: {best_by_high_conf['known_markers_high_conf']} ({best_by_high_conf['known_markers_high_conf_rate']:.1f}%)\")\nprint(f\"  - Total coverage: {best_by_high_conf['known_markers_coverage']:.1f}%\")\nprint(f\"  - Total liver genes: {best_by_high_conf['liver_genes']}\")\nprint(\"\\n\" + \"=\"*80)",
        "detail": "advanced_analysis.optimize_ntpm_threshold",
        "documentation": {}
    },
    {
        "label": "get_output_path",
        "kind": 2,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "def get_output_path(filename: str) -> Path:\n    \"\"\"Get full path for an output file.\"\"\"\n    return OUTPUT_DIR / filename\ndef get_trace_path(filename: str) -> Path:\n    \"\"\"Get full path for a trace file.\"\"\"\n    return TRACE_DIR / filename\ndef get_log_path(filename: str) -> Path:\n    \"\"\"Get full path for a log file.\"\"\"\n    return LOG_DIR / filename",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "get_trace_path",
        "kind": 2,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "def get_trace_path(filename: str) -> Path:\n    \"\"\"Get full path for a trace file.\"\"\"\n    return TRACE_DIR / filename\ndef get_log_path(filename: str) -> Path:\n    \"\"\"Get full path for a log file.\"\"\"\n    return LOG_DIR / filename",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "get_log_path",
        "kind": 2,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "def get_log_path(filename: str) -> Path:\n    \"\"\"Get full path for a log file.\"\"\"\n    return LOG_DIR / filename",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "PROJECT_ROOT",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "PROJECT_ROOT = Path(__file__).parent.parent\nINPUT_DIR = PROJECT_ROOT / 'input'\nOUTPUT_DIR = PROJECT_ROOT / 'output'\nTRACE_DIR = PROJECT_ROOT / 'Trace'\nLOG_DIR = PROJECT_ROOT / 'logs'\n# Ensure directories exist\nfor directory in [OUTPUT_DIR, TRACE_DIR, LOG_DIR]:\n    directory.mkdir(exist_ok=True)\n# =============================================================================\n# INPUT FILES",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "INPUT_DIR",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "INPUT_DIR = PROJECT_ROOT / 'input'\nOUTPUT_DIR = PROJECT_ROOT / 'output'\nTRACE_DIR = PROJECT_ROOT / 'Trace'\nLOG_DIR = PROJECT_ROOT / 'logs'\n# Ensure directories exist\nfor directory in [OUTPUT_DIR, TRACE_DIR, LOG_DIR]:\n    directory.mkdir(exist_ok=True)\n# =============================================================================\n# INPUT FILES\n# =============================================================================",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "OUTPUT_DIR",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "OUTPUT_DIR = PROJECT_ROOT / 'output'\nTRACE_DIR = PROJECT_ROOT / 'Trace'\nLOG_DIR = PROJECT_ROOT / 'logs'\n# Ensure directories exist\nfor directory in [OUTPUT_DIR, TRACE_DIR, LOG_DIR]:\n    directory.mkdir(exist_ok=True)\n# =============================================================================\n# INPUT FILES\n# =============================================================================\nPROTEIN_ATLAS_FILE = INPUT_DIR / 'proteinatlas.tsv'",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "TRACE_DIR",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "TRACE_DIR = PROJECT_ROOT / 'Trace'\nLOG_DIR = PROJECT_ROOT / 'logs'\n# Ensure directories exist\nfor directory in [OUTPUT_DIR, TRACE_DIR, LOG_DIR]:\n    directory.mkdir(exist_ok=True)\n# =============================================================================\n# INPUT FILES\n# =============================================================================\nPROTEIN_ATLAS_FILE = INPUT_DIR / 'proteinatlas.tsv'\nCSV_PATTERN = '*.csv'",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "LOG_DIR",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "LOG_DIR = PROJECT_ROOT / 'logs'\n# Ensure directories exist\nfor directory in [OUTPUT_DIR, TRACE_DIR, LOG_DIR]:\n    directory.mkdir(exist_ok=True)\n# =============================================================================\n# INPUT FILES\n# =============================================================================\nPROTEIN_ATLAS_FILE = INPUT_DIR / 'proteinatlas.tsv'\nCSV_PATTERN = '*.csv'\n# =============================================================================",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "PROTEIN_ATLAS_FILE",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "PROTEIN_ATLAS_FILE = INPUT_DIR / 'proteinatlas.tsv'\nCSV_PATTERN = '*.csv'\n# =============================================================================\n# OUTPUT FILES\n# =============================================================================\n# Visualization outputs\nVENN_DIAGRAM_OUTPUT = OUTPUT_DIR / 'liver_protein_venn_diagram.png'\nNTPM_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_distribution.png'\nGROUP_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_group_distribution.png'\nROC_CURVE_OUTPUT = OUTPUT_DIR / 'roc_auc_analysis.png'",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "CSV_PATTERN",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "CSV_PATTERN = '*.csv'\n# =============================================================================\n# OUTPUT FILES\n# =============================================================================\n# Visualization outputs\nVENN_DIAGRAM_OUTPUT = OUTPUT_DIR / 'liver_protein_venn_diagram.png'\nNTPM_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_distribution.png'\nGROUP_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_group_distribution.png'\nROC_CURVE_OUTPUT = OUTPUT_DIR / 'roc_auc_analysis.png'\nSTRATEGY_COMPARISON_OUTPUT = OUTPUT_DIR / 'classification_strategy_comparison.png'",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "VENN_DIAGRAM_OUTPUT",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "VENN_DIAGRAM_OUTPUT = OUTPUT_DIR / 'liver_protein_venn_diagram.png'\nNTPM_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_distribution.png'\nGROUP_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_group_distribution.png'\nROC_CURVE_OUTPUT = OUTPUT_DIR / 'roc_auc_analysis.png'\nSTRATEGY_COMPARISON_OUTPUT = OUTPUT_DIR / 'classification_strategy_comparison.png'\n# Trace/data outputs\nTRACE_DATA_FILE = TRACE_DIR / 'Data tracing.csv'\nCLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "NTPM_DISTRIBUTION_OUTPUT",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "NTPM_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_distribution.png'\nGROUP_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_group_distribution.png'\nROC_CURVE_OUTPUT = OUTPUT_DIR / 'roc_auc_analysis.png'\nSTRATEGY_COMPARISON_OUTPUT = OUTPUT_DIR / 'classification_strategy_comparison.png'\n# Trace/data outputs\nTRACE_DATA_FILE = TRACE_DIR / 'Data tracing.csv'\nCLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "GROUP_DISTRIBUTION_OUTPUT",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "GROUP_DISTRIBUTION_OUTPUT = OUTPUT_DIR / 'liver_ntpm_group_distribution.png'\nROC_CURVE_OUTPUT = OUTPUT_DIR / 'roc_auc_analysis.png'\nSTRATEGY_COMPARISON_OUTPUT = OUTPUT_DIR / 'classification_strategy_comparison.png'\n# Trace/data outputs\nTRACE_DATA_FILE = TRACE_DIR / 'Data tracing.csv'\nCLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "ROC_CURVE_OUTPUT",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "ROC_CURVE_OUTPUT = OUTPUT_DIR / 'roc_auc_analysis.png'\nSTRATEGY_COMPARISON_OUTPUT = OUTPUT_DIR / 'classification_strategy_comparison.png'\n# Trace/data outputs\nTRACE_DATA_FILE = TRACE_DIR / 'Data tracing.csv'\nCLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS\n# =============================================================================",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "STRATEGY_COMPARISON_OUTPUT",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "STRATEGY_COMPARISON_OUTPUT = OUTPUT_DIR / 'classification_strategy_comparison.png'\n# Trace/data outputs\nTRACE_DATA_FILE = TRACE_DIR / 'Data tracing.csv'\nCLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS\n# =============================================================================\n# nTPM thresholds",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "TRACE_DATA_FILE",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "TRACE_DATA_FILE = TRACE_DIR / 'Data tracing.csv'\nCLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS\n# =============================================================================\n# nTPM thresholds\nNTPM_HIGH_THRESHOLD = 10  # Optimized based on threshold analysis\nNTPM_VERY_HIGH_THRESHOLD = 200",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_SUMMARY_FILE",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "CLASSIFICATION_SUMMARY_FILE = TRACE_DIR / 'classification_summary.csv'\nSORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS\n# =============================================================================\n# nTPM thresholds\nNTPM_HIGH_THRESHOLD = 10  # Optimized based on threshold analysis\nNTPM_VERY_HIGH_THRESHOLD = 200\nNTPM_LOW_THRESHOLD = 0",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "SORTED_GENES_FILE",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "SORTED_GENES_FILE = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nSTRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS\n# =============================================================================\n# nTPM thresholds\nNTPM_HIGH_THRESHOLD = 10  # Optimized based on threshold analysis\nNTPM_VERY_HIGH_THRESHOLD = 200\nNTPM_LOW_THRESHOLD = 0\n# Confidence scoring thresholds",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "STRATEGY_ANALYSIS_FILE",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "STRATEGY_ANALYSIS_FILE = TRACE_DIR / 'classification_strategy_analysis.csv'\n# =============================================================================\n# CLASSIFICATION THRESHOLDS\n# =============================================================================\n# nTPM thresholds\nNTPM_HIGH_THRESHOLD = 10  # Optimized based on threshold analysis\nNTPM_VERY_HIGH_THRESHOLD = 200\nNTPM_LOW_THRESHOLD = 0\n# Confidence scoring thresholds\nCONFIDENCE_HIGH = 80",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "NTPM_HIGH_THRESHOLD",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "NTPM_HIGH_THRESHOLD = 10  # Optimized based on threshold analysis\nNTPM_VERY_HIGH_THRESHOLD = 200\nNTPM_LOW_THRESHOLD = 0\n# Confidence scoring thresholds\nCONFIDENCE_HIGH = 80\nCONFIDENCE_MEDIUM_HIGH = 60\nCONFIDENCE_MEDIUM = 40\nCONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "NTPM_VERY_HIGH_THRESHOLD",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "NTPM_VERY_HIGH_THRESHOLD = 200\nNTPM_LOW_THRESHOLD = 0\n# Confidence scoring thresholds\nCONFIDENCE_HIGH = 80\nCONFIDENCE_MEDIUM_HIGH = 60\nCONFIDENCE_MEDIUM = 40\nCONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS\n# =============================================================================",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "NTPM_LOW_THRESHOLD",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "NTPM_LOW_THRESHOLD = 0\n# Confidence scoring thresholds\nCONFIDENCE_HIGH = 80\nCONFIDENCE_MEDIUM_HIGH = 60\nCONFIDENCE_MEDIUM = 40\nCONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS\n# =============================================================================\n# General settings",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "CONFIDENCE_HIGH",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "CONFIDENCE_HIGH = 80\nCONFIDENCE_MEDIUM_HIGH = 60\nCONFIDENCE_MEDIUM = 40\nCONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS\n# =============================================================================\n# General settings\nDPI = 300\nTOP_N_GENES = 50",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "CONFIDENCE_MEDIUM_HIGH",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "CONFIDENCE_MEDIUM_HIGH = 60\nCONFIDENCE_MEDIUM = 40\nCONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS\n# =============================================================================\n# General settings\nDPI = 300\nTOP_N_GENES = 50\n# Figure sizes (width, height)",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "CONFIDENCE_MEDIUM",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "CONFIDENCE_MEDIUM = 40\nCONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS\n# =============================================================================\n# General settings\nDPI = 300\nTOP_N_GENES = 50\n# Figure sizes (width, height)\nFIGURE_SIZE_LARGE = (20, 13)",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "CONFIDENCE_LOW_MEDIUM",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "CONFIDENCE_LOW_MEDIUM = 20\n# =============================================================================\n# VISUALIZATION SETTINGS\n# =============================================================================\n# General settings\nDPI = 300\nTOP_N_GENES = 50\n# Figure sizes (width, height)\nFIGURE_SIZE_LARGE = (20, 13)\nFIGURE_SIZE_MEDIUM = (14, 16)",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "DPI",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "DPI = 300\nTOP_N_GENES = 50\n# Figure sizes (width, height)\nFIGURE_SIZE_LARGE = (20, 13)\nFIGURE_SIZE_MEDIUM = (14, 16)\nFIGURE_SIZE_SMALL = (10, 8)\nFIGURE_SIZE_VENN = (20, 10)\n# =============================================================================\n# KNOWN LIVER MARKERS (for validation)\n# =============================================================================",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "TOP_N_GENES",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "TOP_N_GENES = 50\n# Figure sizes (width, height)\nFIGURE_SIZE_LARGE = (20, 13)\nFIGURE_SIZE_MEDIUM = (14, 16)\nFIGURE_SIZE_SMALL = (10, 8)\nFIGURE_SIZE_VENN = (20, 10)\n# =============================================================================\n# KNOWN LIVER MARKERS (for validation)\n# =============================================================================\nKNOWN_LIVER_MARKERS = [",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "FIGURE_SIZE_LARGE",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "FIGURE_SIZE_LARGE = (20, 13)\nFIGURE_SIZE_MEDIUM = (14, 16)\nFIGURE_SIZE_SMALL = (10, 8)\nFIGURE_SIZE_VENN = (20, 10)\n# =============================================================================\n# KNOWN LIVER MARKERS (for validation)\n# =============================================================================\nKNOWN_LIVER_MARKERS = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1',\n    'FGA', 'FGB', 'FGG', 'CYP3A4', 'CYP2E1', 'FABP1',",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "FIGURE_SIZE_MEDIUM",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "FIGURE_SIZE_MEDIUM = (14, 16)\nFIGURE_SIZE_SMALL = (10, 8)\nFIGURE_SIZE_VENN = (20, 10)\n# =============================================================================\n# KNOWN LIVER MARKERS (for validation)\n# =============================================================================\nKNOWN_LIVER_MARKERS = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1',\n    'FGA', 'FGB', 'FGG', 'CYP3A4', 'CYP2E1', 'FABP1',\n    'ALDOB', 'ORM1', 'ORM2', 'GC', 'TF', 'APOH', 'APOE',",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "FIGURE_SIZE_SMALL",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "FIGURE_SIZE_SMALL = (10, 8)\nFIGURE_SIZE_VENN = (20, 10)\n# =============================================================================\n# KNOWN LIVER MARKERS (for validation)\n# =============================================================================\nKNOWN_LIVER_MARKERS = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1',\n    'FGA', 'FGB', 'FGG', 'CYP3A4', 'CYP2E1', 'FABP1',\n    'ALDOB', 'ORM1', 'ORM2', 'GC', 'TF', 'APOH', 'APOE',\n    'CRP', 'SAA1', 'SAA2', 'RBP4', 'AMBP', 'SELENOP',",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "FIGURE_SIZE_VENN",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "FIGURE_SIZE_VENN = (20, 10)\n# =============================================================================\n# KNOWN LIVER MARKERS (for validation)\n# =============================================================================\nKNOWN_LIVER_MARKERS = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1',\n    'FGA', 'FGB', 'FGG', 'CYP3A4', 'CYP2E1', 'FABP1',\n    'ALDOB', 'ORM1', 'ORM2', 'GC', 'TF', 'APOH', 'APOE',\n    'CRP', 'SAA1', 'SAA2', 'RBP4', 'AMBP', 'SELENOP',\n    'HRG', 'F2', 'FTL', 'AHSG', 'C3', 'HPX', 'VTN',",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "KNOWN_LIVER_MARKERS",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "KNOWN_LIVER_MARKERS = [\n    'ALB', 'HP', 'APOA1', 'APOA2', 'APOC3', 'SERPINA1',\n    'FGA', 'FGB', 'FGG', 'CYP3A4', 'CYP2E1', 'FABP1',\n    'ALDOB', 'ORM1', 'ORM2', 'GC', 'TF', 'APOH', 'APOE',\n    'CRP', 'SAA1', 'SAA2', 'RBP4', 'AMBP', 'SELENOP',\n    'HRG', 'F2', 'FTL', 'AHSG', 'C3', 'HPX', 'VTN',\n    'ITIH4', 'ITIH3', 'FETUB', 'KNG1', 'SERPINC1',\n    'SERPIND1', 'F9', 'F10', 'F11', 'CYP1A2', 'CYP2A6',\n    'CYP2C8', 'CYP2C9', 'CYP2D6', 'UGT1A1', 'UGT2B7',\n    'GSTA1', 'GSTA2', 'G6PC', 'PCK1'",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "PROTEIN_ATLAS_REQUIRED_COLUMNS",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "PROTEIN_ATLAS_REQUIRED_COLUMNS = [\n    'Gene',\n    'RNA tissue specific nTPM',\n    'Tissue expression cluster',\n    'RNA tissue cell type enrichment'\n]\n# Columns required in gene data\nGENE_DATA_REQUIRED_COLUMNS = ['Gene']\n# =============================================================================\n# HELPER FUNCTIONS",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "GENE_DATA_REQUIRED_COLUMNS",
        "kind": 5,
        "importPath": "core_pipeline.config",
        "description": "core_pipeline.config",
        "peekOfCode": "GENE_DATA_REQUIRED_COLUMNS = ['Gene']\n# =============================================================================\n# HELPER FUNCTIONS\n# =============================================================================\ndef get_output_path(filename: str) -> Path:\n    \"\"\"Get full path for an output file.\"\"\"\n    return OUTPUT_DIR / filename\ndef get_trace_path(filename: str) -> Path:\n    \"\"\"Get full path for a trace file.\"\"\"\n    return TRACE_DIR / filename",
        "detail": "core_pipeline.config",
        "documentation": {}
    },
    {
        "label": "Colors",
        "kind": 6,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "class Colors:\n    \"\"\"ANSI color codes for terminal output.\"\"\"\n    HEADER = '\\033[95m'\n    OKBLUE = '\\033[94m'\n    OKCYAN = '\\033[96m'\n    OKGREEN = '\\033[92m'\n    WARNING = '\\033[93m'\n    FAIL = '\\033[91m'\n    ENDC = '\\033[0m'\n    BOLD = '\\033[1m'",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_header",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_header(message: str, width: int = 80) -> None:\n    \"\"\"\n    Print a formatted header message.\n    Args:\n        message: Header text to display\n        width: Total width of the header (default: 80)\n    \"\"\"\n    print(f\"\\n{Colors.HEADER}{Colors.BOLD}{'='*width}{Colors.ENDC}\")\n    print(f\"{Colors.HEADER}{Colors.BOLD}{message:^{width}}{Colors.ENDC}\")\n    print(f\"{Colors.HEADER}{Colors.BOLD}{'='*width}{Colors.ENDC}\\n\")",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_step",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_step(step_num: int, total_steps: int, message: str) -> None:\n    \"\"\"\n    Print a formatted step message.\n    Args:\n        step_num: Current step number\n        total_steps: Total number of steps\n        message: Step description\n    \"\"\"\n    print(f\"\\n{Colors.OKCYAN}{Colors.BOLD}[Step {step_num}/{total_steps}]{Colors.ENDC} {message}\")\ndef print_success(message: str) -> None:",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_success",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_success(message: str) -> None:\n    \"\"\"\n    Print a success message.\n    Args:\n        message: Success message to display\n    \"\"\"\n    print(f\"{Colors.OKGREEN}✓ {message}{Colors.ENDC}\")\ndef print_error(message: str) -> None:\n    \"\"\"\n    Print an error message.",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_error",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_error(message: str) -> None:\n    \"\"\"\n    Print an error message.\n    Args:\n        message: Error message to display\n    \"\"\"\n    print(f\"{Colors.FAIL}✗ {message}{Colors.ENDC}\")\ndef print_warning(message: str) -> None:\n    \"\"\"\n    Print a warning message.",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_warning",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_warning(message: str) -> None:\n    \"\"\"\n    Print a warning message.\n    Args:\n        message: Warning message to display\n    \"\"\"\n    print(f\"{Colors.WARNING}⚠ {message}{Colors.ENDC}\")\ndef print_info(message: str) -> None:\n    \"\"\"\n    Print an info message.",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_info",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_info(message: str) -> None:\n    \"\"\"\n    Print an info message.\n    Args:\n        message: Info message to display\n    \"\"\"\n    print(f\"{Colors.OKBLUE}ℹ {message}{Colors.ENDC}\")\ndef print_section(title: str) -> None:\n    \"\"\"\n    Print a section title.",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "print_section",
        "kind": 2,
        "importPath": "core_pipeline.console_utils",
        "description": "core_pipeline.console_utils",
        "peekOfCode": "def print_section(title: str) -> None:\n    \"\"\"\n    Print a section title.\n    Args:\n        title: Section title to display\n    \"\"\"\n    print(f\"\\n{Colors.BOLD}{title}{Colors.ENDC}\")\n    print(f\"{Colors.BOLD}{'-' * len(title)}{Colors.ENDC}\")",
        "detail": "core_pipeline.console_utils",
        "documentation": {}
    },
    {
        "label": "validate_input_files",
        "kind": 2,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "def validate_input_files():\n    \"\"\"\n    Validate that all required input files exist and are readable.\n    Returns:\n        bool: True if all files are valid, False otherwise\n    \"\"\"\n    errors = []\n    # Check if input directory exists\n    if not INPUT_DIR.exists():\n        errors.append(f\"Input directory not found: {INPUT_DIR}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "validate_dataframe",
        "kind": 2,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "def validate_dataframe(df, name, required_columns):\n    \"\"\"\n    Validate that a dataframe contains required columns and is not empty.\n    Args:\n        df: pandas DataFrame to validate\n        name: Name of the dataframe (for error messages)\n        required_columns: List of column names that must be present\n    Returns:\n        tuple: (is_valid, errors, warnings)\n            is_valid (bool): True if no critical errors",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "extract_liver_ntpm",
        "kind": 2,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "def extract_liver_ntpm(text):\n    \"\"\"\n    Extract numerical liver nTPM value from text.\n    Args:\n        text: String containing liver nTPM data\n    Returns:\n        float: Liver nTPM value if found, None otherwise\n    \"\"\"\n    if pd.isna(text) or text == '':\n        return None",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "classify_liver_protein",
        "kind": 2,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "def classify_liver_protein(row):\n    has_ntpm_high = row['has_liver_nTPM_high']\n    has_ntpm_low = row['has_liver_nTPM_low']\n    has_cluster = row['has_liver_cluster']\n    has_enrichment = row['has_liver_enrichment']\n    # Count how many conditions are met (treating high and low nTPM as separate)\n    conditions = [has_ntpm_high, has_ntpm_low, has_cluster, has_enrichment]\n    count = sum(conditions)\n    if count == 0:\n        return 'non-liver protein'",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "csv_files",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "csv_files = list(INPUT_DIR.glob(CSV_PATTERN))\nif len(csv_files) > 1:\n    print(f\"⚠ Warning: Multiple CSV files found. Using: {csv_files[0]}\")\n    print(f\"  Other files: {csv_files[1:]}\")\ngene_data_file = csv_files[0]\nprint(f\"  Loading gene data from: {gene_data_file}\")\ntry:\n    gene_data = pd.read_csv(gene_data_file)\nexcept Exception as e:\n    print(f\"❌ Failed to read {gene_data_file}: {str(e)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "gene_data_file",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "gene_data_file = csv_files[0]\nprint(f\"  Loading gene data from: {gene_data_file}\")\ntry:\n    gene_data = pd.read_csv(gene_data_file)\nexcept Exception as e:\n    print(f\"❌ Failed to read {gene_data_file}: {str(e)}\")\n    sys.exit(1)\n# Load protein atlas TSV file\nprint(f\"  Loading protein atlas from: {PROTEIN_ATLAS_FILE}\")\ntry:",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "required_protein_atlas_columns",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "required_protein_atlas_columns = [\n    'Gene',\n    'RNA tissue specific nTPM',\n    'Tissue expression cluster',\n    'RNA tissue cell type enrichment'\n]\nvalid, errors, warnings_pa = validate_dataframe(protein_atlas, \"Protein atlas\", required_protein_atlas_columns)\nif not valid:\n    print(\"\\n❌ Protein atlas validation failed:\")\n    for error in errors:",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data = gene_data.merge(\n    protein_atlas[['Gene', 'RNA tissue specific nTPM', 'Tissue expression cluster', 'RNA tissue cell type enrichment']],\n    on='Gene',\n    how='left'\n)\nprint(f\"  Merged {len(merged_data)} records\")\nif len(merged_data) < len(gene_data):\n    print(f\"  ⚠ Warning: {len(gene_data) - len(merged_data)} genes lost during merge\")\nprint(\"✓ Datasets merged successfully\")\n# =============================================================================",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['liver_nTPM_value']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['liver_nTPM_value'] = merged_data['RNA tissue specific nTPM'].apply(extract_liver_ntpm)\n# Split nTPM into two categories: high (>=100) and low (<100)\nmerged_data['has_liver_in_ntpm'] = merged_data['RNA tissue specific nTPM'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_nTPM_high'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] >= NTPM_HIGH_THRESHOLD)\n)\nmerged_data['has_liver_nTPM_low'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] < NTPM_HIGH_THRESHOLD)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_in_ntpm']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['has_liver_in_ntpm'] = merged_data['RNA tissue specific nTPM'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_nTPM_high'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] >= NTPM_HIGH_THRESHOLD)\n)\nmerged_data['has_liver_nTPM_low'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] < NTPM_HIGH_THRESHOLD)\n)\nmerged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_nTPM_high']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['has_liver_nTPM_high'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] >= NTPM_HIGH_THRESHOLD)\n)\nmerged_data['has_liver_nTPM_low'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] < NTPM_HIGH_THRESHOLD)\n)\nmerged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_nTPM_low']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['has_liver_nTPM_low'] = (\n    merged_data['has_liver_in_ntpm'] &\n    (merged_data['liver_nTPM_value'] < NTPM_HIGH_THRESHOLD)\n)\nmerged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\n# Create classification column with more detailed logic\ndef classify_liver_protein(row):\n    has_ntpm_high = row['has_liver_nTPM_high']\n    has_ntpm_low = row['has_liver_nTPM_low']",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_cluster']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['has_liver_cluster'] = merged_data['Tissue expression cluster'].fillna('').str.lower().str.contains('liver')\nmerged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\n# Create classification column with more detailed logic\ndef classify_liver_protein(row):\n    has_ntpm_high = row['has_liver_nTPM_high']\n    has_ntpm_low = row['has_liver_nTPM_low']\n    has_cluster = row['has_liver_cluster']\n    has_enrichment = row['has_liver_enrichment']\n    # Count how many conditions are met (treating high and low nTPM as separate)\n    conditions = [has_ntpm_high, has_ntpm_low, has_cluster, has_enrichment]",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['has_liver_enrichment']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['has_liver_enrichment'] = merged_data['RNA tissue cell type enrichment'].fillna('').str.lower().str.contains('liver')\n# Create classification column with more detailed logic\ndef classify_liver_protein(row):\n    has_ntpm_high = row['has_liver_nTPM_high']\n    has_ntpm_low = row['has_liver_nTPM_low']\n    has_cluster = row['has_liver_cluster']\n    has_enrichment = row['has_liver_enrichment']\n    # Count how many conditions are met (treating high and low nTPM as separate)\n    conditions = [has_ntpm_high, has_ntpm_low, has_cluster, has_enrichment]\n    count = sum(conditions)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "merged_data['Classification']",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "merged_data['Classification'] = merged_data.apply(classify_liver_protein, axis=1)\n# Count each category\nclassification_counts = merged_data['Classification'].value_counts()\nprint(\"\\n\" + \"=\"*80)\nprint(\"CLASSIFICATION RESULTS\")\nprint(\"=\"*80)\nprint(classification_counts)\nprint(\"=\"*80)\n# Print statistics about extracted liver nTPM values\nliver_ntpm_stats = merged_data[merged_data['liver_nTPM_value'].notna()]['liver_nTPM_value']",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "classification_counts",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "classification_counts = merged_data['Classification'].value_counts()\nprint(\"\\n\" + \"=\"*80)\nprint(\"CLASSIFICATION RESULTS\")\nprint(\"=\"*80)\nprint(classification_counts)\nprint(\"=\"*80)\n# Print statistics about extracted liver nTPM values\nliver_ntpm_stats = merged_data[merged_data['liver_nTPM_value'].notna()]['liver_nTPM_value']\nif len(liver_ntpm_stats) > 0:\n    print(f\"\\nLiver nTPM Value Statistics:\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_ntpm_stats",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_ntpm_stats = merged_data[merged_data['liver_nTPM_value'].notna()]['liver_nTPM_value']\nif len(liver_ntpm_stats) > 0:\n    print(f\"\\nLiver nTPM Value Statistics:\")\n    print(f\"Total genes with liver nTPM values: {len(liver_ntpm_stats)}\")\n    print(f\"Mean: {liver_ntpm_stats.mean():.2f}\")\n    print(f\"Median: {liver_ntpm_stats.median():.2f}\")\n    print(f\"Min: {liver_ntpm_stats.min():.2f}\")\n    print(f\"Max: {liver_ntpm_stats.max():.2f}\")\n# Get gene lists for Venn diagram (4 categories)\nall_genes = set(merged_data['Gene'].tolist())",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "all_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "all_genes = set(merged_data['Gene'].tolist())\nliver_ntpm_high_genes = set(merged_data[merged_data['has_liver_nTPM_high']]['Gene'].tolist())\nliver_ntpm_low_genes = set(merged_data[merged_data['has_liver_nTPM_low']]['Gene'].tolist())\nliver_cluster_genes = set(merged_data[merged_data['has_liver_cluster']]['Gene'].tolist())\nliver_enrichment_genes = set(merged_data[merged_data['has_liver_enrichment']]['Gene'].tolist())\ntotal_genes = len(all_genes)\nliver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_ntpm_high_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_ntpm_high_genes = set(merged_data[merged_data['has_liver_nTPM_high']]['Gene'].tolist())\nliver_ntpm_low_genes = set(merged_data[merged_data['has_liver_nTPM_low']]['Gene'].tolist())\nliver_cluster_genes = set(merged_data[merged_data['has_liver_cluster']]['Gene'].tolist())\nliver_enrichment_genes = set(merged_data[merged_data['has_liver_enrichment']]['Gene'].tolist())\ntotal_genes = len(all_genes)\nliver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_ntpm_low_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_ntpm_low_genes = set(merged_data[merged_data['has_liver_nTPM_low']]['Gene'].tolist())\nliver_cluster_genes = set(merged_data[merged_data['has_liver_cluster']]['Gene'].tolist())\nliver_enrichment_genes = set(merged_data[merged_data['has_liver_enrichment']]['Gene'].tolist())\ntotal_genes = len(all_genes)\nliver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_cluster_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_cluster_genes = set(merged_data[merged_data['has_liver_cluster']]['Gene'].tolist())\nliver_enrichment_genes = set(merged_data[merged_data['has_liver_enrichment']]['Gene'].tolist())\ntotal_genes = len(all_genes)\nliver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")\nprint(f\"Non-liver proteins: {len(non_liver_genes)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_enrichment_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_enrichment_genes = set(merged_data[merged_data['has_liver_enrichment']]['Gene'].tolist())\ntotal_genes = len(all_genes)\nliver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")\nprint(f\"Non-liver proteins: {len(non_liver_genes)}\")\nprint(f\"Genes with liver nTPM ≥100: {len(liver_ntpm_high_genes)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "total_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "total_genes = len(all_genes)\nliver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")\nprint(f\"Non-liver proteins: {len(non_liver_genes)}\")\nprint(f\"Genes with liver nTPM ≥100: {len(liver_ntpm_high_genes)}\")\nprint(f\"Genes with liver nTPM <100: {len(liver_ntpm_low_genes)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_candidates_set",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_candidates_set = liver_ntpm_high_genes | liver_ntpm_low_genes | liver_cluster_genes | liver_enrichment_genes\nliver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")\nprint(f\"Non-liver proteins: {len(non_liver_genes)}\")\nprint(f\"Genes with liver nTPM ≥100: {len(liver_ntpm_high_genes)}\")\nprint(f\"Genes with liver nTPM <100: {len(liver_ntpm_low_genes)}\")\nprint(f\"Genes with liver in Tissue expression cluster: {len(liver_cluster_genes)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_candidates",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_candidates = len(liver_candidates_set)\nnon_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")\nprint(f\"Non-liver proteins: {len(non_liver_genes)}\")\nprint(f\"Genes with liver nTPM ≥100: {len(liver_ntpm_high_genes)}\")\nprint(f\"Genes with liver nTPM <100: {len(liver_ntpm_low_genes)}\")\nprint(f\"Genes with liver in Tissue expression cluster: {len(liver_cluster_genes)}\")\nprint(f\"Genes with liver in RNA tissue cell type enrichment: {len(liver_enrichment_genes)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "non_liver_genes",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "non_liver_genes = all_genes - liver_candidates_set\nprint(f\"\\nVenn Diagram Statistics (4 categories):\")\nprint(f\"Total genes: {total_genes}\")\nprint(f\"Liver protein candidates (union): {liver_candidates}\")\nprint(f\"Non-liver proteins: {len(non_liver_genes)}\")\nprint(f\"Genes with liver nTPM ≥100: {len(liver_ntpm_high_genes)}\")\nprint(f\"Genes with liver nTPM <100: {len(liver_ntpm_low_genes)}\")\nprint(f\"Genes with liver in Tissue expression cluster: {len(liver_cluster_genes)}\")\nprint(f\"Genes with liver in RNA tissue cell type enrichment: {len(liver_enrichment_genes)}\")\nprint(f\"Genes in all 4 categories: {len(liver_ntpm_high_genes & liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "fig",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "fig = plt.figure(figsize=FIGURE_SIZE_VENN)\n# Add overall title with statistics (improved layout)\ntitle_text = f'Liver Protein Classification'\nsubtitle_text = f'nTPM Threshold: {NTPM_HIGH_THRESHOLD} | Total: {total_genes:,} genes | Liver: {liver_candidates:,} ({liver_candidates/total_genes*100:.1f}%) | Non-liver: {len(non_liver_genes):,} ({len(non_liver_genes)/total_genes*100:.1f}%)'\nfig.suptitle(title_text, fontsize=22, fontweight='bold', y=0.97)\nplt.text(0.5, 0.93, subtitle_text, ha='center', fontsize=12, transform=fig.transFigure,\n         bbox=dict(boxstyle='round,pad=0.5', facecolor='#F0F0F0', edgecolor='#CCCCCC', linewidth=1.5, alpha=0.8))\n# Left subplot: nTPM >= threshold with cluster and enrichment\nax1 = fig.add_subplot(121)\nvenn1 = venn3(",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "title_text",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "title_text = f'Liver Protein Classification'\nsubtitle_text = f'nTPM Threshold: {NTPM_HIGH_THRESHOLD} | Total: {total_genes:,} genes | Liver: {liver_candidates:,} ({liver_candidates/total_genes*100:.1f}%) | Non-liver: {len(non_liver_genes):,} ({len(non_liver_genes)/total_genes*100:.1f}%)'\nfig.suptitle(title_text, fontsize=22, fontweight='bold', y=0.97)\nplt.text(0.5, 0.93, subtitle_text, ha='center', fontsize=12, transform=fig.transFigure,\n         bbox=dict(boxstyle='round,pad=0.5', facecolor='#F0F0F0', edgecolor='#CCCCCC', linewidth=1.5, alpha=0.8))\n# Left subplot: nTPM >= threshold with cluster and enrichment\nax1 = fig.add_subplot(121)\nvenn1 = venn3(\n    [liver_ntpm_high_genes, liver_cluster_genes, liver_enrichment_genes],\n    set_labels=('', '', ''),",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "subtitle_text",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "subtitle_text = f'nTPM Threshold: {NTPM_HIGH_THRESHOLD} | Total: {total_genes:,} genes | Liver: {liver_candidates:,} ({liver_candidates/total_genes*100:.1f}%) | Non-liver: {len(non_liver_genes):,} ({len(non_liver_genes)/total_genes*100:.1f}%)'\nfig.suptitle(title_text, fontsize=22, fontweight='bold', y=0.97)\nplt.text(0.5, 0.93, subtitle_text, ha='center', fontsize=12, transform=fig.transFigure,\n         bbox=dict(boxstyle='round,pad=0.5', facecolor='#F0F0F0', edgecolor='#CCCCCC', linewidth=1.5, alpha=0.8))\n# Left subplot: nTPM >= threshold with cluster and enrichment\nax1 = fig.add_subplot(121)\nvenn1 = venn3(\n    [liver_ntpm_high_genes, liver_cluster_genes, liver_enrichment_genes],\n    set_labels=('', '', ''),\n    set_colors=('#FF6B6B', '#87CEEB', '#98FB98'),",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "ax1",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "ax1 = fig.add_subplot(121)\nvenn1 = venn3(\n    [liver_ntpm_high_genes, liver_cluster_genes, liver_enrichment_genes],\n    set_labels=('', '', ''),\n    set_colors=('#FF6B6B', '#87CEEB', '#98FB98'),\n    alpha=0.7,\n    ax=ax1\n)\nax1.set_title(f'High Expression (nTPM ≥ {NTPM_HIGH_THRESHOLD})', fontsize=15, fontweight='bold', pad=20,\n              bbox=dict(boxstyle='round,pad=0.5', facecolor='#FFE6E6', edgecolor='#FF6B6B', linewidth=2))",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "venn1",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "venn1 = venn3(\n    [liver_ntpm_high_genes, liver_cluster_genes, liver_enrichment_genes],\n    set_labels=('', '', ''),\n    set_colors=('#FF6B6B', '#87CEEB', '#98FB98'),\n    alpha=0.7,\n    ax=ax1\n)\nax1.set_title(f'High Expression (nTPM ≥ {NTPM_HIGH_THRESHOLD})', fontsize=15, fontweight='bold', pad=20,\n              bbox=dict(boxstyle='round,pad=0.5', facecolor='#FFE6E6', edgecolor='#FF6B6B', linewidth=2))\n# Customize subset labels for left diagram (nTPM >= 100)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "only_ntpm_high",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "only_ntpm_high = len(liver_ntpm_high_genes - liver_cluster_genes - liver_enrichment_genes)\nonly_cluster_left = len(liver_cluster_genes - liver_ntpm_high_genes - liver_enrichment_genes)\nonly_enrichment_left = len(liver_enrichment_genes - liver_ntpm_high_genes - liver_cluster_genes)\nntpm_high_cluster = len((liver_ntpm_high_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_high_enrichment = len((liver_ntpm_high_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_left = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_high_genes)\nall_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "only_cluster_left",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "only_cluster_left = len(liver_cluster_genes - liver_ntpm_high_genes - liver_enrichment_genes)\nonly_enrichment_left = len(liver_enrichment_genes - liver_ntpm_high_genes - liver_cluster_genes)\nntpm_high_cluster = len((liver_ntpm_high_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_high_enrichment = len((liver_ntpm_high_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_left = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_high_genes)\nall_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)\n    venn1.get_label_by_id('100').set_fontweight('bold')",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "only_enrichment_left",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "only_enrichment_left = len(liver_enrichment_genes - liver_ntpm_high_genes - liver_cluster_genes)\nntpm_high_cluster = len((liver_ntpm_high_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_high_enrichment = len((liver_ntpm_high_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_left = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_high_genes)\nall_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)\n    venn1.get_label_by_id('100').set_fontweight('bold')\nif venn1.get_label_by_id('010'):",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "ntpm_high_cluster",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "ntpm_high_cluster = len((liver_ntpm_high_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_high_enrichment = len((liver_ntpm_high_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_left = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_high_genes)\nall_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)\n    venn1.get_label_by_id('100').set_fontweight('bold')\nif venn1.get_label_by_id('010'):\n    venn1.get_label_by_id('010').set_text(f\"{only_cluster_left}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "ntpm_high_enrichment",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "ntpm_high_enrichment = len((liver_ntpm_high_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_left = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_high_genes)\nall_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)\n    venn1.get_label_by_id('100').set_fontweight('bold')\nif venn1.get_label_by_id('010'):\n    venn1.get_label_by_id('010').set_text(f\"{only_cluster_left}\")\n    venn1.get_label_by_id('010').set_fontsize(14)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "cluster_enrichment_left",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "cluster_enrichment_left = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_high_genes)\nall_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)\n    venn1.get_label_by_id('100').set_fontweight('bold')\nif venn1.get_label_by_id('010'):\n    venn1.get_label_by_id('010').set_text(f\"{only_cluster_left}\")\n    venn1.get_label_by_id('010').set_fontsize(14)\n    venn1.get_label_by_id('010').set_fontweight('bold')",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "all_three_high",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "all_three_high = len(liver_ntpm_high_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn1.get_label_by_id('100'):\n    venn1.get_label_by_id('100').set_text(f\"{only_ntpm_high}\")\n    venn1.get_label_by_id('100').set_fontsize(14)\n    venn1.get_label_by_id('100').set_fontweight('bold')\nif venn1.get_label_by_id('010'):\n    venn1.get_label_by_id('010').set_text(f\"{only_cluster_left}\")\n    venn1.get_label_by_id('010').set_fontsize(14)\n    venn1.get_label_by_id('010').set_fontweight('bold')\nif venn1.get_label_by_id('001'):",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "ax2",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "ax2 = fig.add_subplot(122)\nvenn2 = venn3(\n    [liver_ntpm_low_genes, liver_cluster_genes, liver_enrichment_genes],\n    set_labels=('', '', ''),\n    set_colors=('#FFB6C1', '#87CEEB', '#98FB98'),\n    alpha=0.7,\n    ax=ax2\n)\nax2.set_title(f'Low Expression (nTPM < {NTPM_HIGH_THRESHOLD})', fontsize=15, fontweight='bold', pad=20,\n              bbox=dict(boxstyle='round,pad=0.5', facecolor='#FFE6F0', edgecolor='#FFB6C1', linewidth=2))",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "venn2",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "venn2 = venn3(\n    [liver_ntpm_low_genes, liver_cluster_genes, liver_enrichment_genes],\n    set_labels=('', '', ''),\n    set_colors=('#FFB6C1', '#87CEEB', '#98FB98'),\n    alpha=0.7,\n    ax=ax2\n)\nax2.set_title(f'Low Expression (nTPM < {NTPM_HIGH_THRESHOLD})', fontsize=15, fontweight='bold', pad=20,\n              bbox=dict(boxstyle='round,pad=0.5', facecolor='#FFE6F0', edgecolor='#FFB6C1', linewidth=2))\n# Customize subset labels for right diagram (nTPM < 100)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "only_ntpm_low",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "only_ntpm_low = len(liver_ntpm_low_genes - liver_cluster_genes - liver_enrichment_genes)\nonly_cluster_right = len(liver_cluster_genes - liver_ntpm_low_genes - liver_enrichment_genes)\nonly_enrichment_right = len(liver_enrichment_genes - liver_ntpm_low_genes - liver_cluster_genes)\nntpm_low_cluster = len((liver_ntpm_low_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_low_enrichment = len((liver_ntpm_low_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_right = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_low_genes)\nall_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "only_cluster_right",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "only_cluster_right = len(liver_cluster_genes - liver_ntpm_low_genes - liver_enrichment_genes)\nonly_enrichment_right = len(liver_enrichment_genes - liver_ntpm_low_genes - liver_cluster_genes)\nntpm_low_cluster = len((liver_ntpm_low_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_low_enrichment = len((liver_ntpm_low_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_right = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_low_genes)\nall_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)\n    venn2.get_label_by_id('100').set_fontweight('bold')",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "only_enrichment_right",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "only_enrichment_right = len(liver_enrichment_genes - liver_ntpm_low_genes - liver_cluster_genes)\nntpm_low_cluster = len((liver_ntpm_low_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_low_enrichment = len((liver_ntpm_low_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_right = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_low_genes)\nall_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)\n    venn2.get_label_by_id('100').set_fontweight('bold')\nif venn2.get_label_by_id('010'):",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "ntpm_low_cluster",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "ntpm_low_cluster = len((liver_ntpm_low_genes & liver_cluster_genes) - liver_enrichment_genes)\nntpm_low_enrichment = len((liver_ntpm_low_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_right = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_low_genes)\nall_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)\n    venn2.get_label_by_id('100').set_fontweight('bold')\nif venn2.get_label_by_id('010'):\n    venn2.get_label_by_id('010').set_text(f\"{only_cluster_right}\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "ntpm_low_enrichment",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "ntpm_low_enrichment = len((liver_ntpm_low_genes & liver_enrichment_genes) - liver_cluster_genes)\ncluster_enrichment_right = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_low_genes)\nall_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)\n    venn2.get_label_by_id('100').set_fontweight('bold')\nif venn2.get_label_by_id('010'):\n    venn2.get_label_by_id('010').set_text(f\"{only_cluster_right}\")\n    venn2.get_label_by_id('010').set_fontsize(14)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "cluster_enrichment_right",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "cluster_enrichment_right = len((liver_cluster_genes & liver_enrichment_genes) - liver_ntpm_low_genes)\nall_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)\n    venn2.get_label_by_id('100').set_fontweight('bold')\nif venn2.get_label_by_id('010'):\n    venn2.get_label_by_id('010').set_text(f\"{only_cluster_right}\")\n    venn2.get_label_by_id('010').set_fontsize(14)\n    venn2.get_label_by_id('010').set_fontweight('bold')",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "all_three_low",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "all_three_low = len(liver_ntpm_low_genes & liver_cluster_genes & liver_enrichment_genes)\nif venn2.get_label_by_id('100'):\n    venn2.get_label_by_id('100').set_text(f\"{only_ntpm_low}\")\n    venn2.get_label_by_id('100').set_fontsize(14)\n    venn2.get_label_by_id('100').set_fontweight('bold')\nif venn2.get_label_by_id('010'):\n    venn2.get_label_by_id('010').set_text(f\"{only_cluster_right}\")\n    venn2.get_label_by_id('010').set_fontsize(14)\n    venn2.get_label_by_id('010').set_fontweight('bold')\nif venn2.get_label_by_id('001'):",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "trace_data",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "trace_data = merged_data[[\n    'Gene',\n    'RNA tissue specific nTPM',\n    'liver_nTPM_value',\n    'Tissue expression cluster',\n    'RNA tissue cell type enrichment',\n    'has_liver_nTPM_high',\n    'has_liver_nTPM_low',\n    'has_liver_cluster',\n    'has_liver_enrichment',",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "all_classifications",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "all_classifications = merged_data['Classification'].unique()\nliver_classifications = [c for c in all_classifications if c.startswith('liver protein')]\nfor classification in liver_classifications:\n    subset = merged_data[merged_data['Classification'] == classification]\n    if len(subset) > 0:\n        genes_file = TRACE_DIR / f'{classification.replace(\" \", \"_\").replace(\"(\", \"\").replace(\")\", \"\").replace(\"+\", \"and\")}_genes.csv'\n        subset[['Gene', 'liver_nTPM_value']].to_csv(genes_file, index=False)\n        print(f\"{classification} genes ({len(subset)}): saved to {genes_file}\")\nprint(\"\\n\" + \"=\"*80)\nprint(\"✓ CLASSIFICATION PIPELINE COMPLETED SUCCESSFULLY\")",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "liver_classifications",
        "kind": 5,
        "importPath": "core_pipeline.liver_protein_classifier",
        "description": "core_pipeline.liver_protein_classifier",
        "peekOfCode": "liver_classifications = [c for c in all_classifications if c.startswith('liver protein')]\nfor classification in liver_classifications:\n    subset = merged_data[merged_data['Classification'] == classification]\n    if len(subset) > 0:\n        genes_file = TRACE_DIR / f'{classification.replace(\" \", \"_\").replace(\"(\", \"\").replace(\")\", \"\").replace(\"+\", \"and\")}_genes.csv'\n        subset[['Gene', 'liver_nTPM_value']].to_csv(genes_file, index=False)\n        print(f\"{classification} genes ({len(subset)}): saved to {genes_file}\")\nprint(\"\\n\" + \"=\"*80)\nprint(\"✓ CLASSIFICATION PIPELINE COMPLETED SUCCESSFULLY\")\nprint(\"=\"*80)",
        "detail": "core_pipeline.liver_protein_classifier",
        "documentation": {}
    },
    {
        "label": "run_script",
        "kind": 2,
        "importPath": "core_pipeline.run_visualizations",
        "description": "core_pipeline.run_visualizations",
        "peekOfCode": "def run_script(script_name, description):\n    \"\"\"\n    Run a Python script and return success status\n    Args:\n        script_name (str): Name of the Python script to run\n        description (str): Description of what the script does\n    Returns:\n        bool: True if script ran successfully, False otherwise\n    \"\"\"\n    print(f\"\\n{Colors.OKBLUE}Running: {script_name}{Colors.ENDC}\")",
        "detail": "core_pipeline.run_visualizations",
        "documentation": {}
    },
    {
        "label": "check_prerequisites",
        "kind": 2,
        "importPath": "core_pipeline.run_visualizations",
        "description": "core_pipeline.run_visualizations",
        "peekOfCode": "def check_prerequisites():\n    \"\"\"Check if required files and directories exist\"\"\"\n    print_header(\"Checking Prerequisites\")\n    required_files = [\n        'Trace/Data tracing.csv',\n    ]\n    required_scripts = [\n        'core_pipeline/visualize_ntpm.py',\n        'core_pipeline/visualize_group_distribution.py',\n    ]",
        "detail": "core_pipeline.run_visualizations",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "core_pipeline.run_visualizations",
        "description": "core_pipeline.run_visualizations",
        "peekOfCode": "def main():\n    \"\"\"Main execution function\"\"\"\n    print_header(\"Liver Protein Visualization Pipeline\")\n    print(f\"{Colors.BOLD}This pipeline will generate:{Colors.ENDC}\")\n    print(\"  1. liver_ntpm_distribution.png - Top genes and distribution analysis\")\n    print(\"  2. liver_ntpm_group_distribution.png - Comprehensive group statistics\")\n    print(\"  3. liver_genes_sorted_by_ntpm.csv - Sorted gene list\")\n    # Check prerequisites\n    if not check_prerequisites():\n        print_error(\"\\nPrerequisite check failed. Please ensure all required files exist.\")",
        "detail": "core_pipeline.run_visualizations",
        "documentation": {}
    },
    {
        "label": "format_classification_label",
        "kind": 2,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "def format_classification_label(classification: str, short: bool = True) -> str:\n    \"\"\"\n    Format classification labels for display in plots.\n    Args:\n        classification: Full classification name\n        short: If True, use abbreviated format (default: True)\n    Returns:\n        Formatted label string\n    \"\"\"\n    if not short:",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_COLOR_MAP",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "CLASSIFICATION_COLOR_MAP = {\n    # High nTPM (>=100) categories - Red spectrum\n    'liver protein (nTPM≥100 + cluster + enrichment)': '#FF0000',  # Bright red\n    'liver protein (nTPM≥100 + cluster)': '#FF6B6B',  # Light red\n    'liver protein (nTPM≥100 + enrichment)': '#FF8C42',  # Orange-red\n    'liver protein (nTPM≥100 only)': '#FFB6B6',  # Very light red\n    # Low nTPM (<100) categories - Blue spectrum\n    'liver protein (nTPM<100 + cluster + enrichment)': '#4169E1',  # Royal blue\n    'liver protein (nTPM<100 + cluster)': '#87CEEB',  # Sky blue\n    'liver protein (nTPM<100 + enrichment)': '#ADD8E6',  # Light blue",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "CLASSIFICATION_ORDER",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "CLASSIFICATION_ORDER = [\n    # High nTPM first\n    'liver protein (nTPM≥100 + cluster + enrichment)',\n    'liver protein (nTPM≥100 + cluster)',\n    'liver protein (nTPM≥100 + enrichment)',\n    'liver protein (nTPM≥100 only)',\n    # Low nTPM\n    'liver protein (nTPM<100 + cluster + enrichment)',\n    'liver protein (nTPM<100 + cluster)',\n    'liver protein (nTPM<100 + enrichment)',",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "VENN_HIGH_NTPM_COLOR",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "VENN_HIGH_NTPM_COLOR = '#FF6B6B'  # Light red for nTPM >= 100\nVENN_LOW_NTPM_COLOR = '#FFB6C1'   # Pink for nTPM < 100\nVENN_CLUSTER_COLOR = '#87CEEB'     # Sky blue for cluster\nVENN_ENRICHMENT_COLOR = '#98FB98'  # Pale green for enrichment\n# =============================================================================\n# PLOT AESTHETICS\n# =============================================================================\n# Default alpha transparency\nALPHA_DEFAULT = 0.65\nALPHA_HIGHLIGHT = 0.8",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "VENN_LOW_NTPM_COLOR",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "VENN_LOW_NTPM_COLOR = '#FFB6C1'   # Pink for nTPM < 100\nVENN_CLUSTER_COLOR = '#87CEEB'     # Sky blue for cluster\nVENN_ENRICHMENT_COLOR = '#98FB98'  # Pale green for enrichment\n# =============================================================================\n# PLOT AESTHETICS\n# =============================================================================\n# Default alpha transparency\nALPHA_DEFAULT = 0.65\nALPHA_HIGHLIGHT = 0.8\n# Line widths",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "VENN_CLUSTER_COLOR",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "VENN_CLUSTER_COLOR = '#87CEEB'     # Sky blue for cluster\nVENN_ENRICHMENT_COLOR = '#98FB98'  # Pale green for enrichment\n# =============================================================================\n# PLOT AESTHETICS\n# =============================================================================\n# Default alpha transparency\nALPHA_DEFAULT = 0.65\nALPHA_HIGHLIGHT = 0.8\n# Line widths\nLINE_WIDTH_THIN = 0.5",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "VENN_ENRICHMENT_COLOR",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "VENN_ENRICHMENT_COLOR = '#98FB98'  # Pale green for enrichment\n# =============================================================================\n# PLOT AESTHETICS\n# =============================================================================\n# Default alpha transparency\nALPHA_DEFAULT = 0.65\nALPHA_HIGHLIGHT = 0.8\n# Line widths\nLINE_WIDTH_THIN = 0.5\nLINE_WIDTH_MEDIUM = 1.5",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "ALPHA_DEFAULT",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "ALPHA_DEFAULT = 0.65\nALPHA_HIGHLIGHT = 0.8\n# Line widths\nLINE_WIDTH_THIN = 0.5\nLINE_WIDTH_MEDIUM = 1.5\nLINE_WIDTH_THICK = 2.0\nLINE_WIDTH_VERY_THICK = 2.5\n# Marker sizes\nMARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "ALPHA_HIGHLIGHT",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "ALPHA_HIGHLIGHT = 0.8\n# Line widths\nLINE_WIDTH_THIN = 0.5\nLINE_WIDTH_MEDIUM = 1.5\nLINE_WIDTH_THICK = 2.0\nLINE_WIDTH_VERY_THICK = 2.5\n# Marker sizes\nMARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LINE_WIDTH_THIN",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LINE_WIDTH_THIN = 0.5\nLINE_WIDTH_MEDIUM = 1.5\nLINE_WIDTH_THICK = 2.0\nLINE_WIDTH_VERY_THICK = 2.5\n# Marker sizes\nMARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LINE_WIDTH_MEDIUM",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LINE_WIDTH_MEDIUM = 1.5\nLINE_WIDTH_THICK = 2.0\nLINE_WIDTH_VERY_THICK = 2.5\n# Marker sizes\nMARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LINE_WIDTH_THICK",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LINE_WIDTH_THICK = 2.0\nLINE_WIDTH_VERY_THICK = 2.5\n# Marker sizes\nMARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LINE_WIDTH_VERY_THICK",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LINE_WIDTH_VERY_THICK = 2.5\n# Marker sizes\nMARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "MARKER_SIZE_SMALL",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "MARKER_SIZE_SMALL = 3\nMARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "MARKER_SIZE_MEDIUM",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "MARKER_SIZE_MEDIUM = 30\nMARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "MARKER_SIZE_LARGE",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "MARKER_SIZE_LARGE = 50\n# Font sizes\nFONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION\n# =============================================================================",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "FONT_SIZE_SMALL",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "FONT_SIZE_SMALL = 8\nFONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION\n# =============================================================================\nLEGEND_LOCATION = 'best'\nLEGEND_FRAMEALPHA = 0.95",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "FONT_SIZE_MEDIUM",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "FONT_SIZE_MEDIUM = 10\nFONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION\n# =============================================================================\nLEGEND_LOCATION = 'best'\nLEGEND_FRAMEALPHA = 0.95\nLEGEND_EDGECOLOR = 'black'",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "FONT_SIZE_LARGE",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "FONT_SIZE_LARGE = 12\nFONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION\n# =============================================================================\nLEGEND_LOCATION = 'best'\nLEGEND_FRAMEALPHA = 0.95\nLEGEND_EDGECOLOR = 'black'\nLEGEND_FANCYBOX = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "FONT_SIZE_XLARGE",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "FONT_SIZE_XLARGE = 14\nFONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION\n# =============================================================================\nLEGEND_LOCATION = 'best'\nLEGEND_FRAMEALPHA = 0.95\nLEGEND_EDGECOLOR = 'black'\nLEGEND_FANCYBOX = True\nLEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "FONT_SIZE_TITLE",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "FONT_SIZE_TITLE = 18\n# =============================================================================\n# LEGEND CONFIGURATION\n# =============================================================================\nLEGEND_LOCATION = 'best'\nLEGEND_FRAMEALPHA = 0.95\nLEGEND_EDGECOLOR = 'black'\nLEGEND_FANCYBOX = True\nLEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LEGEND_LOCATION",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LEGEND_LOCATION = 'best'\nLEGEND_FRAMEALPHA = 0.95\nLEGEND_EDGECOLOR = 'black'\nLEGEND_FANCYBOX = True\nLEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LEGEND_FRAMEALPHA",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LEGEND_FRAMEALPHA = 0.95\nLEGEND_EDGECOLOR = 'black'\nLEGEND_FANCYBOX = True\nLEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LEGEND_EDGECOLOR",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LEGEND_EDGECOLOR = 'black'\nLEGEND_FANCYBOX = True\nLEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LEGEND_FANCYBOX",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LEGEND_FANCYBOX = True\nLEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "LEGEND_SHADOW",
        "kind": 5,
        "importPath": "core_pipeline.visualization_config",
        "description": "core_pipeline.visualization_config",
        "peekOfCode": "LEGEND_SHADOW = True",
        "detail": "core_pipeline.visualization_config",
        "documentation": {}
    },
    {
        "label": "trace_data",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "trace_data = pd.read_csv(TRACE_DATA_FILE)\n# Filter genes with liver nTPM values\nliver_genes = trace_data[trace_data['liver_nTPM_value'].notna()].copy()\nprint(f\"Total genes with liver nTPM values: {len(liver_genes)}\")\n# Group by classification\ngroups = liver_genes.groupby('Classification')['liver_nTPM_value'].apply(list).to_dict()\n# Use shared color map and classification order from visualization_config\n# Filter groups that have nTPM values (only those in CLASSIFICATION_ORDER)\ngroups_with_values = {k: v for k, v in groups.items() if k in CLASSIFICATION_ORDER}\n# Create figure with multiple subplots - improved layout",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "liver_genes",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "liver_genes = trace_data[trace_data['liver_nTPM_value'].notna()].copy()\nprint(f\"Total genes with liver nTPM values: {len(liver_genes)}\")\n# Group by classification\ngroups = liver_genes.groupby('Classification')['liver_nTPM_value'].apply(list).to_dict()\n# Use shared color map and classification order from visualization_config\n# Filter groups that have nTPM values (only those in CLASSIFICATION_ORDER)\ngroups_with_values = {k: v for k, v in groups.items() if k in CLASSIFICATION_ORDER}\n# Create figure with multiple subplots - improved layout\nfig = plt.figure(figsize=(22, 16), facecolor='white')\ngs = fig.add_gridspec(3, 2, hspace=0.40, wspace=0.35, top=0.94, bottom=0.06, left=0.08, right=0.96)",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "groups",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "groups = liver_genes.groupby('Classification')['liver_nTPM_value'].apply(list).to_dict()\n# Use shared color map and classification order from visualization_config\n# Filter groups that have nTPM values (only those in CLASSIFICATION_ORDER)\ngroups_with_values = {k: v for k, v in groups.items() if k in CLASSIFICATION_ORDER}\n# Create figure with multiple subplots - improved layout\nfig = plt.figure(figsize=(22, 16), facecolor='white')\ngs = fig.add_gridspec(3, 2, hspace=0.40, wspace=0.35, top=0.94, bottom=0.06, left=0.08, right=0.96)\n# Add overall title\nfig.suptitle('Liver Protein nTPM Distribution Analysis by Classification Group',\n             fontsize=20, fontweight='bold', y=0.98)",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "groups_with_values",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "groups_with_values = {k: v for k, v in groups.items() if k in CLASSIFICATION_ORDER}\n# Create figure with multiple subplots - improved layout\nfig = plt.figure(figsize=(22, 16), facecolor='white')\ngs = fig.add_gridspec(3, 2, hspace=0.40, wspace=0.35, top=0.94, bottom=0.06, left=0.08, right=0.96)\n# Add overall title\nfig.suptitle('Liver Protein nTPM Distribution Analysis by Classification Group',\n             fontsize=20, fontweight='bold', y=0.98)\n# 1. Box Plot (Top Left)\nax1 = fig.add_subplot(gs[0, 0])\ndata_for_box = [groups_with_values[cat] for cat in CLASSIFICATION_ORDER if cat in groups_with_values]",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "fig",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "fig = plt.figure(figsize=(22, 16), facecolor='white')\ngs = fig.add_gridspec(3, 2, hspace=0.40, wspace=0.35, top=0.94, bottom=0.06, left=0.08, right=0.96)\n# Add overall title\nfig.suptitle('Liver Protein nTPM Distribution Analysis by Classification Group',\n             fontsize=20, fontweight='bold', y=0.98)\n# 1. Box Plot (Top Left)\nax1 = fig.add_subplot(gs[0, 0])\ndata_for_box = [groups_with_values[cat] for cat in CLASSIFICATION_ORDER if cat in groups_with_values]\n# Shorten labels for better display\nlabels_for_box = []",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "gs",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "gs = fig.add_gridspec(3, 2, hspace=0.40, wspace=0.35, top=0.94, bottom=0.06, left=0.08, right=0.96)\n# Add overall title\nfig.suptitle('Liver Protein nTPM Distribution Analysis by Classification Group',\n             fontsize=20, fontweight='bold', y=0.98)\n# 1. Box Plot (Top Left)\nax1 = fig.add_subplot(gs[0, 0])\ndata_for_box = [groups_with_values[cat] for cat in CLASSIFICATION_ORDER if cat in groups_with_values]\n# Shorten labels for better display\nlabels_for_box = []\nfor cat in CLASSIFICATION_ORDER:",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "ax1",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "ax1 = fig.add_subplot(gs[0, 0])\ndata_for_box = [groups_with_values[cat] for cat in CLASSIFICATION_ORDER if cat in groups_with_values]\n# Shorten labels for better display\nlabels_for_box = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "data_for_box",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "data_for_box = [groups_with_values[cat] for cat in CLASSIFICATION_ORDER if cat in groups_with_values]\n# Shorten labels for better display\nlabels_for_box = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        labels_for_box.append(label)",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "labels_for_box",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "labels_for_box = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        labels_for_box.append(label)\nbp = ax1.boxplot(data_for_box, labels=labels_for_box, patch_artist=True,\n                 showmeans=True, meanline=True,",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "bp",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "bp = ax1.boxplot(data_for_box, labels=labels_for_box, patch_artist=True,\n                 showmeans=True, meanline=True,\n                 boxprops=dict(linewidth=2),\n                 medianprops=dict(linewidth=2.5, color='red'),\n                 meanprops=dict(linewidth=2.5, color='blue', linestyle='--'),\n                 whiskerprops=dict(linewidth=1.5),\n                 capprops=dict(linewidth=1.5),\n                 flierprops=dict(marker='o', markersize=4, alpha=0.5))\n# Color the boxes using shared color map\nfor patch, cat in zip(bp['boxes'], [c for c in CLASSIFICATION_ORDER if c in groups_with_values]):",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "legend_elements",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "legend_elements = [\n    Line2D([0], [0], color='red', linewidth=2.5, label='Median'),\n    Line2D([0], [0], color='blue', linewidth=2.5, linestyle='--', label='Mean')\n]\nax1.legend(handles=legend_elements, loc='upper right', fontsize=9)\n# 2. Violin Plot (Top Right)\nax2 = fig.add_subplot(gs[0, 1])\n# Prepare data for violin plot\nviolin_data = []\nviolin_labels = []",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "ax2",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "ax2 = fig.add_subplot(gs[0, 1])\n# Prepare data for violin plot\nviolin_data = []\nviolin_labels = []\nviolin_colors = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        violin_data.append(groups_with_values[cat])\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "violin_data",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "violin_data = []\nviolin_labels = []\nviolin_colors = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        violin_data.append(groups_with_values[cat])\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "violin_labels",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "violin_labels = []\nviolin_colors = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        violin_data.append(groups_with_values[cat])\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        violin_labels.append(label)",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "violin_colors",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "violin_colors = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        violin_data.append(groups_with_values[cat])\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        violin_labels.append(label)\n        violin_colors.append(CLASSIFICATION_COLOR_MAP[cat])",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "parts",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "parts = ax2.violinplot(violin_data, positions=range(len(violin_data)),\n                       showmeans=True, showmedians=True, widths=0.7)\n# Color the violins\nfor pc, color in zip(parts['bodies'], violin_colors):\n    pc.set_facecolor(color)\n    pc.set_alpha(0.7)\n    pc.set_edgecolor('black')\n    pc.set_linewidth(1.5)\n# Style the components\nparts['cmeans'].set_color('blue')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "ax3",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "ax3 = fig.add_subplot(gs[1, 0])\npositions = []\nall_values = []\nall_colors = []\nfor i, cat in enumerate(CLASSIFICATION_ORDER):\n    if cat in groups_with_values:\n        values = groups_with_values[cat]\n        positions.extend([i] * len(values))\n        all_values.extend(values)\n        all_colors.extend([CLASSIFICATION_COLOR_MAP[cat]] * len(values))",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "positions",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "positions = []\nall_values = []\nall_colors = []\nfor i, cat in enumerate(CLASSIFICATION_ORDER):\n    if cat in groups_with_values:\n        values = groups_with_values[cat]\n        positions.extend([i] * len(values))\n        all_values.extend(values)\n        all_colors.extend([CLASSIFICATION_COLOR_MAP[cat]] * len(values))\n# Add jitter to x positions",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "all_values",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "all_values = []\nall_colors = []\nfor i, cat in enumerate(CLASSIFICATION_ORDER):\n    if cat in groups_with_values:\n        values = groups_with_values[cat]\n        positions.extend([i] * len(values))\n        all_values.extend(values)\n        all_colors.extend([CLASSIFICATION_COLOR_MAP[cat]] * len(values))\n# Add jitter to x positions\nnp.random.seed(42)",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "all_colors",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "all_colors = []\nfor i, cat in enumerate(CLASSIFICATION_ORDER):\n    if cat in groups_with_values:\n        values = groups_with_values[cat]\n        positions.extend([i] * len(values))\n        all_values.extend(values)\n        all_colors.extend([CLASSIFICATION_COLOR_MAP[cat]] * len(values))\n# Add jitter to x positions\nnp.random.seed(42)\njittered_positions = np.array(positions) + np.random.normal(0, 0.1, len(positions))",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "jittered_positions",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "jittered_positions = np.array(positions) + np.random.normal(0, 0.1, len(positions))\nax3.scatter(jittered_positions, all_values, c=all_colors, alpha=0.5, s=30, edgecolors='black', linewidth=0.5)\n# Overlay box plot\nbp3 = ax3.boxplot(data_for_box, positions=range(len(data_for_box)),\n                  widths=0.3, patch_artist=False,\n                  boxprops=dict(linewidth=2, color='black'),\n                  medianprops=dict(linewidth=2.5, color='red'),\n                  whiskerprops=dict(linewidth=1.5, color='black'),\n                  capprops=dict(linewidth=1.5, color='black'),\n                  showfliers=False)",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "bp3",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "bp3 = ax3.boxplot(data_for_box, positions=range(len(data_for_box)),\n                  widths=0.3, patch_artist=False,\n                  boxprops=dict(linewidth=2, color='black'),\n                  medianprops=dict(linewidth=2.5, color='red'),\n                  whiskerprops=dict(linewidth=1.5, color='black'),\n                  capprops=dict(linewidth=1.5, color='black'),\n                  showfliers=False)\nax3.set_xticks(range(len(labels_for_box)))\nax3.set_xticklabels(labels_for_box, rotation=20, ha='right', fontsize=11)\nax3.set_yscale('log')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "ax4",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "ax4 = fig.add_subplot(gs[1, 1])\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        values = np.array(groups_with_values[cat])\n        log_values = np.log10(values)\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        ax4.hist(log_values, bins=20, alpha=0.5, label=label,",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "ax5",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "ax5 = fig.add_subplot(gs[2, 0])\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        values = sorted(groups_with_values[cat])\n        cumulative = np.arange(1, len(values) + 1) / len(values) * 100\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        ax5.plot(values, cumulative, linewidth=2.5, label=label,",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "ax6",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "ax6 = fig.add_subplot(gs[2, 1])\nax6.axis('off')\n# Calculate statistics\nstats_data = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        values = np.array(groups_with_values[cat])\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "stats_data",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "stats_data = []\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        values = np.array(groups_with_values[cat])\n        label = cat.replace('liver protein ', '').replace('(', '').replace(')', '')\n        label = label.replace('nTPM≥100', '≥100').replace('nTPM<100', '<100')\n        label = label.replace('cluster', 'C').replace('enrichment', 'E')\n        label = label.replace(' + ', '+')\n        stats_data.append([\n            label,",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "column_labels",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "column_labels = ['Group', 'N', 'Mean', 'Median', 'Std Dev', 'Min', 'Max', 'Q1', 'Q3']\ntable = ax6.table(cellText=stats_data, colLabels=column_labels,\n                  cellLoc='center', loc='center',\n                  colWidths=[0.19, 0.09, 0.11, 0.11, 0.11, 0.10, 0.10, 0.09, 0.09])\ntable.auto_set_font_size(False)\ntable.set_fontsize(10)\ntable.scale(1, 2.2)\n# Style header\nfor i in range(len(column_labels)):\n    cell = table[(0, i)]",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "table",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "table = ax6.table(cellText=stats_data, colLabels=column_labels,\n                  cellLoc='center', loc='center',\n                  colWidths=[0.19, 0.09, 0.11, 0.11, 0.11, 0.10, 0.10, 0.09, 0.09])\ntable.auto_set_font_size(False)\ntable.set_fontsize(10)\ntable.scale(1, 2.2)\n# Style header\nfor i in range(len(column_labels)):\n    cell = table[(0, i)]\n    cell.set_facecolor('#4A90E2')",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "output_file",
        "kind": 5,
        "importPath": "core_pipeline.visualize_group_distribution",
        "description": "core_pipeline.visualize_group_distribution",
        "peekOfCode": "output_file = OUTPUT_DIR / 'liver_ntpm_group_distribution.png'\nplt.savefig(output_file, dpi=DPI, bbox_inches='tight')\nprint(f\"\\nComprehensive group distribution saved to: {output_file}\")\n# Print summary\nprint(\"\\n=== Summary Statistics ===\")\nfor cat in CLASSIFICATION_ORDER:\n    if cat in groups_with_values:\n        values = np.array(groups_with_values[cat])\n        print(f\"\\n{cat}:\")\n        print(f\"  N: {len(values)}\")",
        "detail": "core_pipeline.visualize_group_distribution",
        "documentation": {}
    },
    {
        "label": "trace_data",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "trace_data = pd.read_csv(TRACE_DATA_FILE)\n# Filter genes with liver nTPM values and sort by value\nliver_genes = trace_data[trace_data['liver_nTPM_value'].notna()].copy()\nliver_genes = liver_genes.sort_values('liver_nTPM_value', ascending=False)\n# Check liver protein_2 group (no nTPM values expected)\nliver_protein_2_count = len(trace_data[trace_data['Classification'] == 'liver protein_2'])\nprint(f\"Total genes with liver nTPM values: {len(liver_genes)}\")\nprint(f\"Liver protein_2 genes (cluster only, no nTPM): {liver_protein_2_count}\")\nprint(f\"\\nTop 10 genes with highest liver nTPM:\")\nprint(liver_genes[['Gene', 'liver_nTPM_value', 'Classification']].head(10))",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "liver_genes",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "liver_genes = trace_data[trace_data['liver_nTPM_value'].notna()].copy()\nliver_genes = liver_genes.sort_values('liver_nTPM_value', ascending=False)\n# Check liver protein_2 group (no nTPM values expected)\nliver_protein_2_count = len(trace_data[trace_data['Classification'] == 'liver protein_2'])\nprint(f\"Total genes with liver nTPM values: {len(liver_genes)}\")\nprint(f\"Liver protein_2 genes (cluster only, no nTPM): {liver_protein_2_count}\")\nprint(f\"\\nTop 10 genes with highest liver nTPM:\")\nprint(liver_genes[['Gene', 'liver_nTPM_value', 'Classification']].head(10))\n# 1. Create horizontal bar plot for top genes\nfig, axes = plt.subplots(2, 1, figsize=(14, 16))",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "liver_genes",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "liver_genes = liver_genes.sort_values('liver_nTPM_value', ascending=False)\n# Check liver protein_2 group (no nTPM values expected)\nliver_protein_2_count = len(trace_data[trace_data['Classification'] == 'liver protein_2'])\nprint(f\"Total genes with liver nTPM values: {len(liver_genes)}\")\nprint(f\"Liver protein_2 genes (cluster only, no nTPM): {liver_protein_2_count}\")\nprint(f\"\\nTop 10 genes with highest liver nTPM:\")\nprint(liver_genes[['Gene', 'liver_nTPM_value', 'Classification']].head(10))\n# 1. Create horizontal bar plot for top genes\nfig, axes = plt.subplots(2, 1, figsize=(14, 16))\n# Top N genes from config",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "liver_protein_2_count",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "liver_protein_2_count = len(trace_data[trace_data['Classification'] == 'liver protein_2'])\nprint(f\"Total genes with liver nTPM values: {len(liver_genes)}\")\nprint(f\"Liver protein_2 genes (cluster only, no nTPM): {liver_protein_2_count}\")\nprint(f\"\\nTop 10 genes with highest liver nTPM:\")\nprint(liver_genes[['Gene', 'liver_nTPM_value', 'Classification']].head(10))\n# 1. Create horizontal bar plot for top genes\nfig, axes = plt.subplots(2, 1, figsize=(14, 16))\n# Top N genes from config\ntop_genes = liver_genes.head(TOP_N_GENES)\n# Use shared color map from visualization_config",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "top_genes",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "top_genes = liver_genes.head(TOP_N_GENES)\n# Use shared color map from visualization_config\ncolors = []\nfor classification in top_genes['Classification']:\n    colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\n# Plot top 50\nax1 = axes[0]\nbars = ax1.barh(range(len(top_genes)), top_genes['liver_nTPM_value'], color=colors, edgecolor='black', linewidth=0.5)\nax1.set_yticks(range(len(top_genes)))\nax1.set_yticklabels(top_genes['Gene'], fontsize=9)",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "colors",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "colors = []\nfor classification in top_genes['Classification']:\n    colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\n# Plot top 50\nax1 = axes[0]\nbars = ax1.barh(range(len(top_genes)), top_genes['liver_nTPM_value'], color=colors, edgecolor='black', linewidth=0.5)\nax1.set_yticks(range(len(top_genes)))\nax1.set_yticklabels(top_genes['Gene'], fontsize=9)\nax1.set_xlabel('Liver nTPM Value', fontsize=12, fontweight='bold')\nax1.set_title(f'Top {TOP_N_GENES} Genes by Liver nTPM Value', fontsize=14, fontweight='bold', pad=15)",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ax1",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ax1 = axes[0]\nbars = ax1.barh(range(len(top_genes)), top_genes['liver_nTPM_value'], color=colors, edgecolor='black', linewidth=0.5)\nax1.set_yticks(range(len(top_genes)))\nax1.set_yticklabels(top_genes['Gene'], fontsize=9)\nax1.set_xlabel('Liver nTPM Value', fontsize=12, fontweight='bold')\nax1.set_title(f'Top {TOP_N_GENES} Genes by Liver nTPM Value', fontsize=14, fontweight='bold', pad=15)\nax1.invert_yaxis()\nax1.grid(axis='x', alpha=0.3, linestyle='--')\n# Add value labels on bars\nfor i, (idx, row) in enumerate(top_genes.iterrows()):",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "bars",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "bars = ax1.barh(range(len(top_genes)), top_genes['liver_nTPM_value'], color=colors, edgecolor='black', linewidth=0.5)\nax1.set_yticks(range(len(top_genes)))\nax1.set_yticklabels(top_genes['Gene'], fontsize=9)\nax1.set_xlabel('Liver nTPM Value', fontsize=12, fontweight='bold')\nax1.set_title(f'Top {TOP_N_GENES} Genes by Liver nTPM Value', fontsize=14, fontweight='bold', pad=15)\nax1.invert_yaxis()\nax1.grid(axis='x', alpha=0.3, linestyle='--')\n# Add value labels on bars\nfor i, (idx, row) in enumerate(top_genes.iterrows()):\n    value = row['liver_nTPM_value']",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "unique_classifications",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "unique_classifications = top_genes['Classification'].unique()\nlegend_elements = []\n# High nTPM categories\nif 'liver protein (nTPM≥100 + cluster + enrichment)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FF0000', edgecolor='black', label='nTPM≥100 + C + E', linewidth=1.5))\nif 'liver protein (nTPM≥100 + cluster)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FF6B6B', edgecolor='black', label='nTPM≥100 + C', linewidth=1.5))\nif 'liver protein (nTPM≥100 + enrichment)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FF8C42', edgecolor='black', label='nTPM≥100 + E', linewidth=1.5))\nif 'liver protein (nTPM≥100 only)' in unique_classifications:",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "legend_elements",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "legend_elements = []\n# High nTPM categories\nif 'liver protein (nTPM≥100 + cluster + enrichment)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FF0000', edgecolor='black', label='nTPM≥100 + C + E', linewidth=1.5))\nif 'liver protein (nTPM≥100 + cluster)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FF6B6B', edgecolor='black', label='nTPM≥100 + C', linewidth=1.5))\nif 'liver protein (nTPM≥100 + enrichment)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FF8C42', edgecolor='black', label='nTPM≥100 + E', linewidth=1.5))\nif 'liver protein (nTPM≥100 only)' in unique_classifications:\n    legend_elements.append(Patch(facecolor='#FFB6B6', edgecolor='black', label='nTPM≥100 only', linewidth=1.5))",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ax2",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ax2 = axes[1]\nliver_genes_sorted = liver_genes.sort_values('liver_nTPM_value', ascending=True)\nx_positions = range(len(liver_genes_sorted))\nvalues = liver_genes_sorted['liver_nTPM_value'].values\n# Color by classification using shared color map\nscatter_colors = []\nfor classification in liver_genes_sorted['Classification']:\n    scatter_colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\nax2.scatter(x_positions, values, c=scatter_colors, alpha=0.6, s=30, edgecolors='black', linewidth=0.5)\nax2.set_xlabel('Gene Index (sorted by nTPM value)', fontsize=12, fontweight='bold')",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "liver_genes_sorted",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "liver_genes_sorted = liver_genes.sort_values('liver_nTPM_value', ascending=True)\nx_positions = range(len(liver_genes_sorted))\nvalues = liver_genes_sorted['liver_nTPM_value'].values\n# Color by classification using shared color map\nscatter_colors = []\nfor classification in liver_genes_sorted['Classification']:\n    scatter_colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\nax2.scatter(x_positions, values, c=scatter_colors, alpha=0.6, s=30, edgecolors='black', linewidth=0.5)\nax2.set_xlabel('Gene Index (sorted by nTPM value)', fontsize=12, fontweight='bold')\nax2.set_ylabel('Liver nTPM Value (log scale)', fontsize=12, fontweight='bold')",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "x_positions",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "x_positions = range(len(liver_genes_sorted))\nvalues = liver_genes_sorted['liver_nTPM_value'].values\n# Color by classification using shared color map\nscatter_colors = []\nfor classification in liver_genes_sorted['Classification']:\n    scatter_colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\nax2.scatter(x_positions, values, c=scatter_colors, alpha=0.6, s=30, edgecolors='black', linewidth=0.5)\nax2.set_xlabel('Gene Index (sorted by nTPM value)', fontsize=12, fontweight='bold')\nax2.set_ylabel('Liver nTPM Value (log scale)', fontsize=12, fontweight='bold')\nax2.set_yscale('log')",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "values",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "values = liver_genes_sorted['liver_nTPM_value'].values\n# Color by classification using shared color map\nscatter_colors = []\nfor classification in liver_genes_sorted['Classification']:\n    scatter_colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\nax2.scatter(x_positions, values, c=scatter_colors, alpha=0.6, s=30, edgecolors='black', linewidth=0.5)\nax2.set_xlabel('Gene Index (sorted by nTPM value)', fontsize=12, fontweight='bold')\nax2.set_ylabel('Liver nTPM Value (log scale)', fontsize=12, fontweight='bold')\nax2.set_yscale('log')\nax2.set_title('Distribution of Liver nTPM Values Across All Genes', fontsize=14, fontweight='bold', pad=15)",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "scatter_colors",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "scatter_colors = []\nfor classification in liver_genes_sorted['Classification']:\n    scatter_colors.append(CLASSIFICATION_COLOR_MAP.get(classification, '#CCCCCC'))\nax2.scatter(x_positions, values, c=scatter_colors, alpha=0.6, s=30, edgecolors='black', linewidth=0.5)\nax2.set_xlabel('Gene Index (sorted by nTPM value)', fontsize=12, fontweight='bold')\nax2.set_ylabel('Liver nTPM Value (log scale)', fontsize=12, fontweight='bold')\nax2.set_yscale('log')\nax2.set_title('Distribution of Liver nTPM Values Across All Genes', fontsize=14, fontweight='bold', pad=15)\nax2.grid(True, alpha=0.3, linestyle='--')\n# Create legend with updated classifications",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "unique_scatter_classifications",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "unique_scatter_classifications = liver_genes_sorted['Classification'].unique()\nlegend_elements_scatter = []\n# High nTPM categories\nif 'liver protein (nTPM≥100 + cluster + enrichment)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FF0000', edgecolor='black', label='nTPM≥100 + C + E', alpha=0.7, linewidth=1.5))\nif 'liver protein (nTPM≥100 + cluster)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FF6B6B', edgecolor='black', label='nTPM≥100 + C', alpha=0.7, linewidth=1.5))\nif 'liver protein (nTPM≥100 + enrichment)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FF8C42', edgecolor='black', label='nTPM≥100 + E', alpha=0.7, linewidth=1.5))\nif 'liver protein (nTPM≥100 only)' in unique_scatter_classifications:",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "legend_elements_scatter",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "legend_elements_scatter = []\n# High nTPM categories\nif 'liver protein (nTPM≥100 + cluster + enrichment)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FF0000', edgecolor='black', label='nTPM≥100 + C + E', alpha=0.7, linewidth=1.5))\nif 'liver protein (nTPM≥100 + cluster)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FF6B6B', edgecolor='black', label='nTPM≥100 + C', alpha=0.7, linewidth=1.5))\nif 'liver protein (nTPM≥100 + enrichment)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FF8C42', edgecolor='black', label='nTPM≥100 + E', alpha=0.7, linewidth=1.5))\nif 'liver protein (nTPM≥100 only)' in unique_scatter_classifications:\n    legend_elements_scatter.append(Patch(facecolor='#FFB6B6', edgecolor='black', label='nTPM≥100 only', alpha=0.7, linewidth=1.5))",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_high_ce",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_high_ce = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 + cluster + enrichment)\"])\nntpm_high_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 + cluster)\"])\nntpm_high_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 + enrichment)\"])\nntpm_high_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 only)\"])\nntpm_low_ce = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster + enrichment)\"])\nntpm_low_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster)\"])\nntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_high_c",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_high_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 + cluster)\"])\nntpm_high_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 + enrichment)\"])\nntpm_high_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 only)\"])\nntpm_low_ce = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster + enrichment)\"])\nntpm_low_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster)\"])\nntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_high_e",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_high_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 + enrichment)\"])\nntpm_high_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 only)\"])\nntpm_low_ce = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster + enrichment)\"])\nntpm_low_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster)\"])\nntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_high_only",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_high_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM≥100 only)\"])\nntpm_low_ce = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster + enrichment)\"])\nntpm_low_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster)\"])\nntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_low_ce",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_low_ce = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster + enrichment)\"])\nntpm_low_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster)\"])\nntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_low_c",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_low_c = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + cluster)\"])\nntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_low_e",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_low_e = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 + enrichment)\"])\nntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'\nstats_text += f'  +C: {ntpm_high_c}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "ntpm_low_only",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "ntpm_low_only = len(liver_genes[liver_genes[\"Classification\"] == \"liver protein (nTPM<100 only)\"])\n# Count those without nTPM values\ncluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'\nstats_text += f'  +C: {ntpm_high_c}\\n'\nstats_text += f'  +E: {ntpm_high_e}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "cluster_only",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "cluster_only = len(trace_data[trace_data['Classification'] == 'liver protein (cluster only)'])\nenrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'\nstats_text += f'  +C: {ntpm_high_c}\\n'\nstats_text += f'  +E: {ntpm_high_e}\\n'\nstats_text += f'  only: {ntpm_high_only}\\n'\nstats_text += f'nTPM<{NTPM_HIGH_THRESHOLD}:\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "enrichment_only",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "enrichment_only = len(trace_data[trace_data['Classification'] == 'liver protein (enrichment only)'])\ncluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'\nstats_text += f'  +C: {ntpm_high_c}\\n'\nstats_text += f'  +E: {ntpm_high_e}\\n'\nstats_text += f'  only: {ntpm_high_only}\\n'\nstats_text += f'nTPM<{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_low_ce}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "cluster_enrichment",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "cluster_enrichment = len(trace_data[trace_data['Classification'] == 'liver protein (cluster + enrichment)'])\nstats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'\nstats_text += f'  +C: {ntpm_high_c}\\n'\nstats_text += f'  +E: {ntpm_high_e}\\n'\nstats_text += f'  only: {ntpm_high_only}\\n'\nstats_text += f'nTPM<{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_low_ce}\\n'\nstats_text += f'  +C: {ntpm_low_c}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "stats_text",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "stats_text = f'nTPM values: {len(liver_genes)}\\n'\nstats_text += f'nTPM≥{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_high_ce}\\n'\nstats_text += f'  +C: {ntpm_high_c}\\n'\nstats_text += f'  +E: {ntpm_high_e}\\n'\nstats_text += f'  only: {ntpm_high_only}\\n'\nstats_text += f'nTPM<{NTPM_HIGH_THRESHOLD}:\\n'\nstats_text += f'  +C+E: {ntpm_low_ce}\\n'\nstats_text += f'  +C: {ntpm_low_c}\\n'\nstats_text += f'  +E: {ntpm_low_e}\\n'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "output_file",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "output_file = OUTPUT_DIR / 'liver_ntpm_distribution.png'\nplt.savefig(output_file, dpi=DPI, bbox_inches='tight')\nprint(f\"\\nDistribution plot saved to: {output_file}\")\nplt.close()\n# 3. Create a detailed table with all genes sorted by nTPM value\nprint(\"\\nCreating detailed CSV file sorted by nTPM value...\")\nliver_genes_detailed = liver_genes[['Gene', 'liver_nTPM_value', 'Classification',\n                                     'RNA tissue specific nTPM', 'Tissue expression cluster']].copy()\nliver_genes_detailed = liver_genes_detailed.sort_values('liver_nTPM_value', ascending=False)\nsorted_genes_file = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "liver_genes_detailed",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "liver_genes_detailed = liver_genes[['Gene', 'liver_nTPM_value', 'Classification',\n                                     'RNA tissue specific nTPM', 'Tissue expression cluster']].copy()\nliver_genes_detailed = liver_genes_detailed.sort_values('liver_nTPM_value', ascending=False)\nsorted_genes_file = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nliver_genes_detailed.to_csv(sorted_genes_file, index=False)\nprint(f\"Detailed sorted gene list saved to: {sorted_genes_file}\")\nprint(\"\\nAll visualizations completed successfully!\")\nprint(f\"\\nGenerated files:\")\nprint(f\"1. {output_file} - Top {TOP_N_GENES} bar chart and distribution\")\nprint(f\"2. {sorted_genes_file} - Complete sorted gene list\")",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "liver_genes_detailed",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "liver_genes_detailed = liver_genes_detailed.sort_values('liver_nTPM_value', ascending=False)\nsorted_genes_file = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nliver_genes_detailed.to_csv(sorted_genes_file, index=False)\nprint(f\"Detailed sorted gene list saved to: {sorted_genes_file}\")\nprint(\"\\nAll visualizations completed successfully!\")\nprint(f\"\\nGenerated files:\")\nprint(f\"1. {output_file} - Top {TOP_N_GENES} bar chart and distribution\")\nprint(f\"2. {sorted_genes_file} - Complete sorted gene list\")",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "sorted_genes_file",
        "kind": 5,
        "importPath": "core_pipeline.visualize_ntpm",
        "description": "core_pipeline.visualize_ntpm",
        "peekOfCode": "sorted_genes_file = TRACE_DIR / 'liver_genes_sorted_by_ntpm.csv'\nliver_genes_detailed.to_csv(sorted_genes_file, index=False)\nprint(f\"Detailed sorted gene list saved to: {sorted_genes_file}\")\nprint(\"\\nAll visualizations completed successfully!\")\nprint(f\"\\nGenerated files:\")\nprint(f\"1. {output_file} - Top {TOP_N_GENES} bar chart and distribution\")\nprint(f\"2. {sorted_genes_file} - Complete sorted gene list\")",
        "detail": "core_pipeline.visualize_ntpm",
        "documentation": {}
    },
    {
        "label": "run_script",
        "kind": 2,
        "importPath": "run_pipeline",
        "description": "run_pipeline",
        "peekOfCode": "def run_script(script_name, description):\n    \"\"\"\n    Run a Python script and return success status\n    Args:\n        script_name (str): Name of the Python script to run\n        description (str): Description of what the script does\n    Returns:\n        bool: True if script ran successfully, False otherwise\n    \"\"\"\n    print(f\"\\n{Colors.OKBLUE}Running: {script_name}{Colors.ENDC}\")",
        "detail": "run_pipeline",
        "documentation": {}
    },
    {
        "label": "check_input_files",
        "kind": 2,
        "importPath": "run_pipeline",
        "description": "run_pipeline",
        "peekOfCode": "def check_input_files():\n    \"\"\"Check if required input files exist\"\"\"\n    print_header(\"Checking Input Files\")\n    required_files = [\n        'input/proteinatlas.tsv',\n        'input/*.csv',  # At least one CSV file\n    ]\n    print(f\"{Colors.BOLD}Required input files:{Colors.ENDC}\")\n    # Check TSV file\n    tsv_path = Path('input/proteinatlas.tsv')",
        "detail": "run_pipeline",
        "documentation": {}
    },
    {
        "label": "check_trace_data",
        "kind": 2,
        "importPath": "run_pipeline",
        "description": "run_pipeline",
        "peekOfCode": "def check_trace_data():\n    \"\"\"Check if trace data exists (for visualization-only mode)\"\"\"\n    trace_file = Path('Trace/Data tracing.csv')\n    return trace_file.exists()\ndef run_full_pipeline(include_advanced=True):\n    \"\"\"\n    Run the full analysis pipeline\n    Args:\n        include_advanced (bool): Whether to include advanced analysis steps\n    \"\"\"",
        "detail": "run_pipeline",
        "documentation": {}
    },
    {
        "label": "run_full_pipeline",
        "kind": 2,
        "importPath": "run_pipeline",
        "description": "run_pipeline",
        "peekOfCode": "def run_full_pipeline(include_advanced=True):\n    \"\"\"\n    Run the full analysis pipeline\n    Args:\n        include_advanced (bool): Whether to include advanced analysis steps\n    \"\"\"\n    pipeline_steps = [\n        {\n            'name': 'Classification',\n            'script': 'core_pipeline/liver_protein_classifier.py',",
        "detail": "run_pipeline",
        "documentation": {}
    },
    {
        "label": "run_visualization_only",
        "kind": 2,
        "importPath": "run_pipeline",
        "description": "run_pipeline",
        "peekOfCode": "def run_visualization_only():\n    \"\"\"Run only visualization scripts (requires existing trace data)\"\"\"\n    print_header(\"Running Visualization Only\")\n    if not check_trace_data():\n        print_error(\"Trace data not found: Trace/Data tracing.csv\")\n        print_info(\"Please run the full pipeline or classification step first\")\n        return False\n    print_success(\"Found trace data\")\n    return run_script('core_pipeline/run_visualizations.py', 'Generate all visualization plots')\ndef main():",
        "detail": "run_pipeline",
        "documentation": {}
    },
    {
        "label": "main",
        "kind": 2,
        "importPath": "run_pipeline",
        "description": "run_pipeline",
        "peekOfCode": "def main():\n    \"\"\"Main execution function\"\"\"\n    parser = argparse.ArgumentParser(\n        description='Liver Protein Analysis Pipeline',\n        formatter_class=argparse.RawDescriptionHelpFormatter,\n        epilog=\"\"\"\nExamples:\n  python run_pipeline.py              # Run full pipeline with advanced analysis\n  python run_pipeline.py --quick      # Run only classification and basic visualization\n  python run_pipeline.py --viz-only   # Run only visualization (requires existing data)",
        "detail": "run_pipeline",
        "documentation": {}
    }
]